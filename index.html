<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">

<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;mozartto.cn&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Muse&quot;,&quot;version&quot;:&quot;8.4.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;always&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:true,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;Searching...&quot;,&quot;empty&quot;:&quot;We didn&#39;t find any results for the search: ${query}&quot;,&quot;hits_time&quot;:&quot;${hits} results found in ${time} ms&quot;,&quot;hits&quot;:&quot;${hits} results found&quot;},&quot;path&quot;:&quot;&#x2F;search.xml&quot;,&quot;localsearch&quot;:{&quot;enable&quot;:true,&quot;trigger&quot;:&quot;auto&quot;,&quot;top_n_per_article&quot;:1,&quot;unescape&quot;:false,&quot;preload&quot;:false}}</script>
<meta name="description" content="a blog about some record in life">
<meta property="og:type" content="website">
<meta property="og:title" content="Motto">
<meta property="og:url" content="https://mozartto.cn/index.html">
<meta property="og:site_name" content="Motto">
<meta property="og:description" content="a blog about some record in life">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Motto">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://mozartto.cn/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;en&quot;,&quot;comments&quot;:&quot;&quot;,&quot;permalink&quot;:&quot;&quot;,&quot;path&quot;:&quot;index.html&quot;,&quot;title&quot;:&quot;&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>Motto</title><script src="/js/config.js"></script>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Motto</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">simple makes better</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-computer"><a href="/categories/computer/" rel="section"><i class="fas fa-laptop fa-fw"></i>computer</a></li>
        <li class="menu-item menu-item-books"><a href="/books/" rel="section"><i class="fas fa-book fa-fw"></i>books</a></li>
        <li class="menu-item menu-item-life"><a href="/categories/life/" rel="section"><i class="fas fa-mug-hot fa-fw"></i>life</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-games"><a href="/games/" rel="section"><i class="fab  fa-steam fa-fw"></i>games</a></li>
        <li class="menu-item menu-item-other"><a href="/categories/other/" rel="section"><i class="fas fa-glass-cheers fa-fw"></i>other</a></li>
        <li class="menu-item menu-item-message"><a href="/message/" rel="section"><i class="fas fa-comment-dots fa-fw"></i>message</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Motto"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Motto</p>
  <div class="site-description" itemprop="description">a blog about some record in life</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Mozartto" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Mozartto" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=1220883974@qq.com" title="E-Mail → https:&#x2F;&#x2F;mail.qq.com&#x2F;cgi-bin&#x2F;qm_share?t&#x3D;qm_mailme&amp;email&#x3D;1220883974@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/Jerry21313800" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;Jerry21313800" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.quora.com/profile/Jerry-1020" title="Quora → https:&#x2F;&#x2F;www.quora.com&#x2F;profile&#x2F;Jerry-1020" rel="noopener" target="_blank"><i class="fab fa-quora fa-fw"></i>Quora</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/Mozartto" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2021/05/23/JavaEE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/23/JavaEE/" class="post-title-link" itemprop="url">JavaWeb</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-23 00:06:29" itemprop="dateCreated datePublished" datetime="2021-05-23T00:06:29+08:00">2021-05-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/computer/" itemprop="url" rel="index"><span itemprop="name">computer</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2021/05/23/JavaEE/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2021/05/23/JavaEE/" class="cy_cmt_count" data-xid="2021/05/23/JavaEE/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>8.9k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>8 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="JavaWeb"><a href="#JavaWeb" class="headerlink" title="JavaWeb"></a>JavaWeb</h2><h3 id="认识JavaEE的项目结构"><a href="#认识JavaEE的项目结构" class="headerlink" title="认识JavaEE的项目结构"></a>认识JavaEE的项目结构</h3><p>一般我们部署的JavaEE项目会放在tomcat容器的webapps里面，里面默认已有的项目有：</p>
<ol>
<li>docs</li>
<li>examples</li>
<li>host-manager</li>
<li>manager</li>
<li>ROOT</li>
</ol>
<p>上面的每个文件夹里面都会有一些静态资源，比如css、js、index.html，除此之外，还有一个WEB-INF文件夹，这个是受保护的资源目录</p>
<p>在浏览器中<a href="http://localhost:8080代表的就是tomcat中的webapps文件夹。WEB-INF文件夹中的文件不能被直接访问到，必须要通过请求转发访问。为什么里面的文件不能被访问到呢？这跟里面装的文件内容有关。">http://localhost:8080代表的就是tomcat中的webapps文件夹。WEB-INF文件夹中的文件不能被直接访问到，必须要通过请求转发访问。为什么里面的文件不能被访问到呢？这跟里面装的文件内容有关。</a></p>
<p>一般的WEB-INF文件夹中会有这些文件：</p>
<ol>
<li>classes目录，IDEA编译后的文件</li>
<li>lib目录，存放jar包的</li>
<li>web.xml，项目的配置信息</li>
</ol>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210322095952567.png" alt="image-20210322095952567" style="zoom:70%;" />

<p>一个web项目目录的结构如上图。</p>
<p>认识完JavaEE的项目结构之后，我们还需要了解一些学习JavaWeb所需的前置基础知识</p>
<h3 id="前置基础知识："><a href="#前置基础知识：" class="headerlink" title="前置基础知识："></a>前置基础知识：</h3><ol>
<li>HTTP，HTTP是超文本传输协议的英文简称，也就是说平时我们看到的网页其实是一个包含了许多超链接的文本，超文本意思就是一个页面里不止有文本，还有图片、音乐、视频等等。</li>
<li>我们客户端（PC）在浏览器中输入一串网址时，客户端PC通过网络向服务器发送了一个请求，服务器接收到请求之后会响应客户端。也就是说每一次我们访问网络上的一些资源（存储在服务器中），我们都要向服务器发送一个请求，然后服务器将资源返回给我们（响应）。</li>
</ol>
<p>那请求和响应对应的报文格式是什么呢？</p>
<p>请求的主要组成部分：</p>
<ol>
<li>请求行 request line  </li>
<li>请求头 request headers</li>
<li>请求体 request body</li>
</ol>
<p>请求行： 请求方式（默认为GET）+ 你访问的网址（URL） +  使用的协议</p>
<p>请求头：一些键值对信息，一些配置信息</p>
<p>请求体：里面存放请求的内容。get方式请求，请求的数据直接放在url地址后；post方式请求，请求体中才会有请求数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210327123107915.png" alt="image-20210327123107915"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210327123324072.png" alt="image-20210327123324072"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210327123428087.png" alt="image-20210327123428087"></p>
<p>GET请求方式和POST请求方式的区别：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210327123627577.png" alt="image-20210327123627577"></p>
<p>响应行格式为协议+响应状态码。响应头与请求头一样，其中存放一些键值对配置信息，响应体中存放服务器返回的资源</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210327124322859.png" alt="image-20210327124322859"></p>
<p>响应头中的键值对具体内容：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210327125338719.png" alt="image-20210327125338719"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210327125416838.png" alt="image-20210327125416838"></p>
<p>MIME类型，就是告诉浏览器我给你响应的文件是什么类型，是图片、视频、音频还是HTML文档这些。</p>
<p>前置基础知识大概就这些，下面我们来看Servlet</p>
<h3 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h3><p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210327153857359.png" alt="image-20210327153857359"></p>
<h3 id="第一个servlet小程序"><a href="#第一个servlet小程序" class="headerlink" title="第一个servlet小程序"></a>第一个servlet小程序</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">cn<span class="token punctuation">.</span>mozartto<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Random</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Myservlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/*
    要继承这个类，我们所写的项目才是一个servlet项目，否则只是一个简单的JavaSE项目
    继承了这个类之后我们的代码就可以接收浏览器发来的请求并作出运算与响应
    要想对浏览器做出相应必须重写HttpServlet类中的service方法
     */</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">service</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//接收请求和做出响应的方法必须定义在service方法中</span>
        <span class="token comment">//本方法的参数是两个对象，一个对象代表请求，另一个对象代表响应</span>
        <span class="token comment">//如果我们想获得请求中的信息，就要通过HttpServletRequest获得</span>
        <span class="token comment">//如果我们想给浏览器响应一些信息，就要通过HttpServletResponse对象响应</span>

        <span class="token comment">//希望实现的功能：</span>
        <span class="token comment">//在后台随机生成一个整数，当浏览器请求一个servlet时</span>
        <span class="token comment">//如果生成的是奇数，返回“happy new year”</span>
        <span class="token comment">//如果生成的是偶数，返回“happy birthday”</span>

        <span class="token comment">//动态生成数据</span>
        <span class="token keyword">int</span> num <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> massage <span class="token operator">=</span> num <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">"happy birthday"</span> <span class="token operator">:</span> <span class="token string">"happy new year"</span><span class="token punctuation">;</span>

        <span class="token comment">//对浏览器做出响应</span>
        <span class="token class-name">PrintWriter</span> writer <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//通过响应对象可以获得一个打印流，该打印流指向浏览器</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>massage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>写完了这段代码之后，如何让浏览器获取并显示我们的结果呢？</p>
<p>首先，在IDEA中启动配置好的tomcat服务器：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210327182442776.png" alt="image-20210327182442776"></p>
<p>启动tomcat服务器之后，我们会发现我们左侧的项目模块上面多出了一个out文件夹，IDEA编译后的代码都放在这里面，Tomcat使用的也是这里面的资源。</p>
<p>我们写的Java代码放在src文件夹下，启动tomcat服务器时IDEA会自动进行编译，想要让浏览器显示服务器计算完之后的的响应内容，需要配置WEB-INF包下的web.xml文件。xml文件相当于是一个可以自定义标签的html，但是只负责传输内容，不作为。</p>
<p>web.xml文件配置如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210327182929575.png" alt="image-20210327182929575"></p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/javaee<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd<span class="token punctuation">"</span></span>
         <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

    <span class="token comment">&lt;!-- 向tomcat生明一个servlet --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>MyServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!--别名，外号--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>cn.mozartto.servlet.Myservlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!-- 对应的servlet类 --></span>
        <span class="token comment">&lt;!--
        现在我们想让浏览器执行src文件下我们写好的Java代码，就需要通过xml。上面这是配置xml的步骤
        --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 给servlet匹配一个请求的映射路径,代表要给上面的别名起一个请求的映射路径 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>MyServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/MyServlet.do<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Servlet简单案例开发"><a href="#Servlet简单案例开发" class="headerlink" title="Servlet简单案例开发"></a>Servlet简单案例开发</h3><p>喵的，我寻思servlet都这么古老的技术了，但是还是得了解一下，但好像没必要做那么详细的笔记…每篇笔记还得把xml文档和html文档粘进来，本来Java代码就够看的了…还要我去读xml和html，这笔记记完怕是以后自己都不想看…所以servlet了解即可，那就愉快听课！</p>
<h3 id="Request获取请求行和请求头"><a href="#Request获取请求行和请求头" class="headerlink" title="Request获取请求行和请求头"></a>Request获取请求行和请求头</h3><p>get方法提交的表单信息直接放在地址栏里面进行传输（账号密码什么的都直接在后面变成一大串URL…很不安全啊！！而且由于其传输的信息都放在地址栏里面，所以没有请求体。</p>
<p>POST方法传输的信息都放在请求体里面，很安全，大妙</p>
<p>request对象有很多方法可以获取请求中的数据，获取请求行的数据，等等等等，一堆方法</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210329193647975.png" alt="image-20210329193647975"></p>
<h3 id="Request获取请求参数"><a href="#Request获取请求参数" class="headerlink" title="Request获取请求参数"></a>Request获取请求参数</h3><p>GET方式提交数据有一个缺点，就是数据只能通过地址栏提交，数据格式只能是文本，而POST方式提交的数据可以是多种不同的数据类型</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210329200347959.png" alt="image-20210329200347959"></p>
<p>在web.xml中配置（添加）自己写的servlet类语法如下（都是这个步骤）：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210329200717860.png" alt="image-20210329200717860"></p>
<h3 id="Response设置响应"><a href="#Response设置响应" class="headerlink" title="Response设置响应"></a>Response设置响应</h3><p>通过reps对象，其中有许多方法可以设置响应头的键值对信息</p>
<h3 id="Servlet继承结构"><a href="#Servlet继承结构" class="headerlink" title="Servlet继承结构"></a>Servlet继承结构</h3><p>servlet继承结构关系图如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210330164503587.png" alt="image-20210330164503587"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210330164418007.png" alt="image-20210330164418007"></p>
<p>注意事项：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210330135217728.png" alt="image-20210330135217728"></p>
<h3 id="ServletContext对象"><a href="#ServletContext对象" class="headerlink" title="ServletContext对象"></a>ServletContext对象</h3><ol>
<li>相对路径转绝对路径</li>
<li>获取容器的附加信息</li>
<li>读取配置信息</li>
<li>全局容器</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210330165011164.png" alt="image-20210330165011164"></p>
<h3 id="URLPattern匹配规则"><a href="#URLPattern匹配规则" class="headerlink" title="URLPattern匹配规则"></a>URLPattern匹配规则</h3><p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210330185457832.png" alt="image-20210330185457832"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210330185654261.png" alt="image-20210330185654261"></p>
<h3 id="注解模式开发servlet"><a href="#注解模式开发servlet" class="headerlink" title="注解模式开发servlet"></a>注解模式开发servlet</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210330192207459.png" alt="image-20210330192207459"></p>
<p>每一次新建一个servlet都要重新配置web.xml里面的信息，可能太麻烦了，其实我们可以直接通过注解来配置servlet里面的信息。</p>
<p>当我们新建一个servlet（类）时，我们可以在类前面加上一个注解@WebServlet，如上图所示。可以配置urlPatterns，还可以初始化一些ServletContext中的键值对参数</p>
<h3 id="forward请求转发"><a href="#forward请求转发" class="headerlink" title="forward请求转发"></a>forward请求转发</h3><p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210330193659091.png" alt="image-20210330193659091"></p>
<p>servlet1响应不了的内容，转发给servlet2响应</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210330200455826.png" alt="image-20210330200455826"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210330200940437.png" alt="image-20210330200940437"></p>
<p>servlet1也可以增加响应，就在servlet1中使用resp.getwriter().println(“响应”)就可以了</p>
<p>但是在forward转发模式下，请求应该完全交给目标资源去处理，我们在资源组件中，不要做出任何的响应处理。</p>
<p>在forward方法调用之后，也不要再使用req和resp对象做其它操作了</p>
<h3 id="include请求转发（了解）"><a href="#include请求转发（了解）" class="headerlink" title="include请求转发（了解）"></a>include请求转发（了解）</h3><p>include请求转发和forward请求转发的区别就是换了一个调用的函数。</p>
<p>include转发的处理流程就是servlet2处理完servlet1的请求转发之后，响应给servlet1，然后servlet1再响应给客户端    </p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210330201727468.png" alt="image-20210330201727468" style="zoom:67%;" />

<p>servlet1中要增加的内容，增加的响应内容是servlet1在响应之前向客户端发送的内容，之后会再向客户端发送响应的内容</p>
<p>forward是完全托管给目标资源，include是让目标资源完成部分工作</p>
<p>在include转发模式下，设置响应可以在转发之前，也可以在转发之后</p>
<p>实际开发中，forward用得比较多，因为include请求转发返还给servlet1之后还要进行一些编码，比较麻烦，让servlet2全部托管即可</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210330205939751.png" alt="image-20210330205939751" style="zoom:80%;" />



<h3 id="响应重定向处理"><a href="#响应重定向处理" class="headerlink" title="响应重定向处理"></a>响应重定向处理</h3><p>由响应对象告诉浏览器你去找别人给你进行响应。如下图，servlet3处理不了的时候就告诉servlet4，让servlet4去处理。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210331091239939.png" alt="image-20210331091239939"></p>
<ol>
<li>响应重定向是服务器给浏览器重新指定请求方向，这个请求是浏览器再次发送新的请求，所以是一种浏览器行为  地址栏会发生变化</li>
<li>重定向时，请求对象和响应对象都会再次产生，请求中的参数是不会携带的（req和resp）</li>
<li>重定向也可以帮助我们完成页面跳转</li>
<li>重定向不能帮助我们访问WEB-INF中的资源</li>
<li>重定向可以定向到外部资源</li>
</ol>
<h3 id="前端路径问题"><a href="#前端路径问题" class="headerlink" title="前端路径问题"></a>前端路径问题</h3><p>讲一下相对路径和绝对路径的问题。以及基于相对路径的base标签</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210331204733082.png" alt="image-20210331204733082"></p>
<h3 id="请求转发路径问题"><a href="#请求转发路径问题" class="headerlink" title="请求转发路径问题"></a>请求转发路径问题</h3><p>请求转发路径问题就和前端路径问题相似，也有相对路径和绝对路径。通过urlpatterns来设置的功能和base标签的功能类似</p>
<h3 id="响应重定向路径问题"><a href="#响应重定向路径问题" class="headerlink" title="响应重定向路径问题"></a>响应重定向路径问题</h3><p>相对路径：相对于urlpatterns定义的路径</p>
<p>绝对路径：以项目的部署路径为基准路径 webapps</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210331212048031.png" alt="image-20210331212048031"></p>
<p>可以通过contextpath获取项目部署名，这样以后改了也没事</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210331212421337.png" alt="image-20210331212421337"></p>
<h3 id="会话概念引入"><a href="#会话概念引入" class="headerlink" title="会话概念引入"></a>会话概念引入</h3><p>枯燥的前面部分终于告一段落了，cookie和seesion即将闪亮登场！（我滴妈，终于肝到这儿了….）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210331214347688.png" alt="image-20210331214347688"></p>
<h3 id="Cookie和Session的引入"><a href="#Cookie和Session的引入" class="headerlink" title="Cookie和Session的引入"></a>Cookie和Session的引入</h3><p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210401103850680.png" alt="image-20210401103850680"></p>
<p>每一次浏览器（客户端）向服务端发送一个请求之后，服务端都会创建一个对应的HTTPSession对象（账户），并生成一个JSESSIONID数据（卡号），响应回一个Cookie，里面包含了JSESSIONID。下一次浏览器向服务端发送请求时就会默认携带上一次返回的Cooike。</p>
<p>注意：用户端在向服务A发送请求时，携带的是服务A返回的Cookie，服务B的Cookie并不会被携带，对应不同的服务端携带不同的Cookie</p>
<h3 id="响应Cookie"><a href="#响应Cookie" class="headerlink" title="响应Cookie"></a>响应Cookie</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">"/servlet1.do"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Servlet1</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span><span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">service</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//通过响应对象，向浏览器响应一些Cookie</span>
        <span class="token comment">//Cookie的构造方法中传入两个参数，一个是键，一个是值，组成一个键值对</span>

        <span class="token class-name">Cookie</span> c1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span><span class="token string">"10"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Cookie</span> c2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token string">"gender"</span><span class="token punctuation">,</span><span class="token string">"male"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//我们现在想要通过服务器给浏览器响应数据，只需要把cookie放入resp响应对象中即可</span>
        c2<span class="token punctuation">.</span><span class="token function">setMaxAge</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置Cookie在浏览器中保存的时间，以秒为单位</span>
        resp<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="读取Cookie"><a href="#读取Cookie" class="headerlink" title="读取Cookie"></a>读取Cookie</h3><p>就是在另外一个servlet中获取cookie，代码不放了。</p>
<h3 id="关于Cookie的跨域（了解）"><a href="#关于Cookie的跨域（了解）" class="headerlink" title="关于Cookie的跨域（了解）"></a>关于Cookie的跨域（了解）</h3><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210401182130769.png" alt="image-20210401182130769" style="zoom:200%;" />





<h3 id="小案例开发——Cookie记录访问次数"><a href="#小案例开发——Cookie记录访问次数" class="headerlink" title="小案例开发——Cookie记录访问次数"></a>小案例开发——Cookie记录访问次数</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">cn<span class="token punctuation">.</span>mozartto<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">Cookie</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">"/servlet2.do"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Servlet2</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">service</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//如果是第一次访问当前Servlet，向浏览器响应一个Cookie（"servlet2", "1")</span>
        <span class="token comment">//如果是多次访问，就在次数上+1</span>
        <span class="token class-name">Cookie</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cookies <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getCookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> cookies<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Cookie</span> cookie <span class="token operator">:</span> cookies<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">String</span> cookieName <span class="token operator">=</span> cookie<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>cookieName<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"servlet2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    <span class="token comment">//创建cookie，次数+1</span>
                    <span class="token class-name">Integer</span> value <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>cookie<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token class-name">Cookie</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token string">"servlet2"</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">//创建完cookie之后，再把cookie放入到响应对象中即可</span>
                    resp<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"欢迎您第"</span><span class="token operator">+</span>value<span class="token operator">+</span><span class="token string">"次访问"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//说明访问过</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//如果flag为false</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"欢迎您第一次访问"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Cookie</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token string">"servlet2"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//将第一次访问生成的cookie放入resp响应对象中</span>
            resp<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h3 id="HttpSeesion的使用"><a href="#HttpSeesion的使用" class="headerlink" title="HttpSeesion的使用"></a>HttpSeesion的使用</h3><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210401212357795.png" alt="image-20210401212357795" style="zoom:80%;" />



<p>可以设置session的存活时间</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210401212432464.png" alt="image-20210401212432464"></p>
<p>servlet1：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210401212059880.png" alt="image-20210401212059880"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210401212213670.png" alt="image-20210401212213670"></p>
<p>servlet2：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210401212303263.png" alt="image-20210401212303263"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210401213114973.png" alt="image-20210401213114973"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210401213143474.png" alt="image-20210401213143474"></p>
<p>结束会话后session会被销毁。比如关闭浏览器后再访问浏览器不会发送JSESSIONID，是发送一个请求，然后服务端创建新的JSESSIONID响应给浏览器。</p>
<p>还可以设置session的销毁时间，比如一分钟浏览器没有被操作那么则session销毁</p>
<h3 id="单次绘画登录页面案例"><a href="#单次绘画登录页面案例" class="headerlink" title="单次绘画登录页面案例"></a>单次绘画登录页面案例</h3><p>代码之后复习servlet时再放</p>
<h3 id="域对象概念的引入"><a href="#域对象概念的引入" class="headerlink" title="域对象概念的引入"></a>域对象概念的引入</h3><p>什么是域对象？</p>
<p>能够存储数据，获取数据，传递数据数据的对象</p>
<p>Servlet三大域对象：</p>
<p>Request域——HTTPServletRequest对象     范围：一次请求、请求转发</p>
<p>Session域——HTTPSession对象                    范围：一次会话（跨请求）</p>
<p>Application域——ServletContext对象          范围：任意一次请求和会话（跨会话）</p>
<p>setAttribute(name, value); 设置修改数据</p>
<p>getAttribute(name); 获得数据的方法</p>
<p>removeAttribute(name); 移除数据的方法</p>
<p>JSP四大域对象：Page域、Request域、Session域、Application域</p>
<h3 id="Request域"><a href="#Request域" class="headerlink" title="Request域"></a>Request域</h3><p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210402195801313.png" alt="image-20210402195801313"></p>
<p>servlet1中的数据请求转发到servlet2，servlet的request中原有的数据不是request域的数据，servlet1的request对象中原有的数据会跟随请求转发直接发送到servlet2的request对象中。而request域中的数据是我们添加或者修改的数据，就是我们可以直接对servlet1中request域中的数据进行修改，具体操作如下图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210402195717104.png" alt="image-20210402195717104"></p>
<p>获得request域中的数据用getAttribute，获得request对象中原有的数据（客户端传来的）用getParameter方法</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210402195717104.png" alt="image-20210402195649548"></p>
<p>域对象中修改或添加的数据也会随请求转发一起被发送</p>
<p>使用响应重定向传递数据</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">resp<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span><span class="token string">"readFromRequest.do"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>会发现servlet2中所有输出的request域中的数据都变成了null</p>
<p>因为响应重定向是servlet1告诉浏览器你自己去找servlet2吧，这样的话浏览器自己去访问servlet2，会产生一个新的request对象，而新的request对象不是servlet1中的request对象。</p>
<h3 id="Session域传递数据"><a href="#Session域传递数据" class="headerlink" title="Session域传递数据"></a>Session域传递数据</h3><p>session域传递数据使用响应重定向可以传递数据，因为session域传递数据是可以跨请求的，所以不论是请求转发还是响应重定向都可以传递数据。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210402202809576.png" alt="image-20210402202809576"></p>
<p>从servlet1传递数据到servlet2中，范围是session域</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210402202956474.png" alt="image-20210402202956474"></p>
<p>注意此时在sevlet2中就不能再用request对象操作数据了，而要先获取servlet2的session对象，然后用session对象来操作数据。此时请求中的数据就不能再处理了，比如最后两行的对req的操作。</p>
<p>此时你启动tomcat，在浏览器中访问read From Session.do,可以看到servlet1通过session域传递到servlet2中的数据，但是如果此时你关闭浏览器再重启或者清空浏览器的cookie就会发现原来的数据session域中的数据访问不了了，因为session域中的数据访问范围在是一次会话之内。</p>
<p>session对象存活的时间比request对象长，request对象在一次请求完成之后就被回收了，但是HttpSession存活的就比较久，第一次请求过来的时候它被创建了，第二次请求的时候可能还是这个session，第三次可能还是它（只要你不关闭浏览器或手动清除cookie（结束会话）），session就会存在</p>
<h3 id="Application域传递数据"><a href="#Application域传递数据" class="headerlink" title="Application域传递数据"></a>Application域传递数据</h3><p>跨会话传递数据，即可以跨session传递数据，把getsession换成getServletContext即可</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210402204347797.png" alt="image-20210402204347797"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210402204520491.png" alt="image-20210402204520491"></p>
<p>application域中的数据在服务器重启后会被回收，一般不要往application中放具体某个用户的数据，只放整个项目的配置数据。application域是我们在实际开发中要尽量少操作的域，因为它生命周期太长了，容易造成冗余或用户之间产生干扰。</p>
<h2 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h2><p>老技术，但是是MVC架构的基础，所以还是得学学。</p>
<h3 id="Servlet作为页面动态资源的弊端"><a href="#Servlet作为页面动态资源的弊端" class="headerlink" title="Servlet作为页面动态资源的弊端"></a>Servlet作为页面动态资源的弊端</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210402211155898.png" alt="image-20210402211155898"></p>
<p>总结：servlet作为动态资源会使得页面资源的操作非常繁琐，非常不利于页面的更新和维护，所以servlet不可以做为页面资源。servlet一般专门用于接收用户端数据，向用户端响应数据，控制前后端页面跳转，交互逻辑等，在MVC模式下作为控制层使用。</p>
<h3 id="JSP中插入Java代码的语法"><a href="#JSP中插入Java代码的语法" class="headerlink" title="JSP中插入Java代码的语法"></a>JSP中插入Java代码的语法</h3><pre class="line-numbers language-jsp" data-language="jsp"><code class="language-jsp">&lt;%
JAVA代码
%&gt;

&lt;%--
注释
--%&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>将变量或值打印到页面上：&lt;%=变量值%&gt;</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210405212524661.png" alt="image-20210405212524661"></p>
<h3 id="JSP的原理"><a href="#JSP的原理" class="headerlink" title="JSP的原理"></a>JSP的原理</h3><p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210405213246415.png" alt="image-20210405213246415"></p>
<p>大致了解即可。毕竟JSP，运行原理大致了解即可。</p>
<h3 id="JSP的执行过程"><a href="#JSP的执行过程" class="headerlink" title="JSP的执行过程"></a>JSP的执行过程</h3><p>略</p>
<h3 id="JSP继承结构"><a href="#JSP继承结构" class="headerlink" title="JSP继承结构"></a>JSP继承结构</h3><p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210405215043022.png" alt="image-20210405215043022"></p>
<p>我们需要重写的就是service方法，JSP和servlet及其类似</p>
<h3 id="JSP剩余重要知识点合集"><a href="#JSP剩余重要知识点合集" class="headerlink" title="JSP剩余重要知识点合集"></a>JSP剩余重要知识点合集</h3><p>由于多方面考虑，现对JSP进行简化了解即可。</p>
<ol>
<li><p>EL表达式：使用 ＄{参数名} ——即可输出参数，使用EL表达式可以很方便地引用一些JavaBean以及其属性，不会抛出NullPointerException之类的错误。</p>
</li>
<li><p>JSTL表达式</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/picturesimage-20210406110246531.png" alt="image-20210406110246531"></p>
</li>
</ol>
<p>c是cycle的意思，意思就是循环。</p>
<p><strong>记住：JSP我们只需要了解即可，不需要深入去学习每个知识点，因为在现实开发中很可能用不上。</strong></p>
<h3 id="MVC模式概念引入"><a href="#MVC模式概念引入" class="headerlink" title="MVC模式概念引入"></a>MVC模式概念引入</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413095521254.png" alt="image-20210413095521254"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413095723644.png" alt="image-20210413095723644"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413100157707.png" alt="image-20210413100157707"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413102334916.png" alt="image-20210413102334916"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2021/05/22/espa%C3%B1ol/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/22/espa%C3%B1ol/" class="post-title-link" itemprop="url">español</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-22 14:15:48" itemprop="dateCreated datePublished" datetime="2021-05-22T14:15:48+08:00">2021-05-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/other/" itemprop="url" rel="index"><span itemprop="name">other</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2021/05/22/espa%C3%B1ol/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2021/05/22/espa%C3%B1ol/" class="cy_cmt_count" data-xid="2021/05/22/español/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>7</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>español</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2021/05/22/record/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/22/record/" class="post-title-link" itemprop="url">record</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-22 14:15:01" itemprop="dateCreated datePublished" datetime="2021-05-22T14:15:01+08:00">2021-05-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/life/" itemprop="url" rel="index"><span itemprop="name">life</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2021/05/22/record/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2021/05/22/record/" class="cy_cmt_count" data-xid="2021/05/22/record/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>9</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="financial"><a href="#financial" class="headerlink" title="financial"></a>financial</h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2021/05/20/multithread/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/20/multithread/" class="post-title-link" itemprop="url">multithreading and high currency</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-20 19:30:16" itemprop="dateCreated datePublished" datetime="2021-05-20T19:30:16+08:00">2021-05-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/computer/" itemprop="url" rel="index"><span itemprop="name">computer</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2021/05/20/multithread/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2021/05/20/multithread/" class="cy_cmt_count" data-xid="2021/05/20/multithread/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>9.9k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>9 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>The high concurrency will not be talked in this article today, let’s talk about multithreading first.</p>
<h2 id="Multithreading"><a href="#Multithreading" class="headerlink" title="Multithreading"></a>Multithreading</h2><h3 id="The-first-way-to-create-a-thread-implements-Thread"><a href="#The-first-way-to-create-a-thread-implements-Thread" class="headerlink" title="The first way to create a thread: implements Thread"></a>The first way to create a thread: implements Thread</h3>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/05/20/multithread/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2021/03/28/Spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/03/28/Spring/" class="post-title-link" itemprop="url">Spring Framework</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-03-28 11:54:46 / Modified: 17:23:39" itemprop="dateCreated datePublished" datetime="2021-03-28T11:54:46+08:00">2021-03-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/computer/" itemprop="url" rel="index"><span itemprop="name">computer</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2021/03/28/Spring/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2021/03/28/Spring/" class="cy_cmt_count" data-xid="2021/03/28/Spring/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>8.8k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>8 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h2><p>Spring的功能是降低耦合，还有整合其它框架。比如SpringMVC和MyBatis都可以整合到Spring中。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410184125297.png" alt="image-20210410184125297" style="zoom:67%;" />

<h3 id="Spring-Ioc概念引入"><a href="#Spring-Ioc概念引入" class="headerlink" title="Spring_Ioc概念引入"></a>Spring_Ioc概念引入</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410184450871.png" alt="image-20210410184450871"></p>
<p>我们想创建对象时是直接到容器里面去取，而不是自己现场创建实现类。所有实现类全部放在容器里。我们直接在配置文件中指定一下实现类的路径即可。创建对象的权利由我们自己反转给了配置文件和容器，这种控制方式可以降低模块之间的耦合度。当我们需要修改某个对象时，不需要在模块中现场修改对象，只需要修改配置文件即可。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410185905670.png" alt="image-20210410185905670"></p>
<h3 id="Spring-Ioc代码测试"><a href="#Spring-Ioc代码测试" class="headerlink" title="Spring_Ioc代码测试"></a>Spring_Ioc代码测试</h3><p>首先先创建一个maven项目（maven项目的创建步骤参考maven笔记），然后导入spring容器的五个核心jar包（在pom.xml文件中使用dependency导入，依赖的代码到mvnrepository.com里面去找。四个核心jar包是上面绿色图中的Beans、Core、Context、SpEL</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411111008461.png" alt="image-20210411111008461" style="zoom:60%;" />

<p>其实我们只需要导一个context包，它就包含了上面的四个核心jar包。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411111322195.png" alt="image-20210411111322195" style="zoom:67%;" />

<p>如何查看当前导入的依赖的关系图：点击右侧侧边栏上的maven，然后点击右上角那个闪电图标右侧的那个有两个箭头的图标即可查看到如下图所示的注入依赖的关系图：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411111502441.png" alt="image-20210411111502441"></p>
<p>我们要进行测试（test文件夹下的代码），所以还要导一个junit包，在mvn仓库里面找。</p>
<p>之前我们在写mybatis的时候操作每个数据库表都需要自己在Java文件夹中创建一个对应的实体类，test方法每次都要new一个实体类对应的实现类对象。上面说过这样的话项目耦合度过高。所以我们要创建一个容器，然后把对象全部放到容器中去，然后通过一个配置文件访问我们所需的对象。那IDEA提供了一种非常便利的创建Spring配置文件的方法。如下图，在创建新的xml文档的时候可以直接创建spring Config文件。（注意是在maven项目的resources目录下建）</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411113740662.png" alt="image-20210411113740662"></p>
<p>因为我们有连接数据库的DAO文件（之前mybatis中的mapper文件），那么我们要对应的实现类，实现类要自己写（之前学mybatis的时候是把操作数据库的方法写在一个接口里做抽象方法，然后在mapper里具体实现，并且要创建一个接口对应的实现类，在test方法中创建实现类对象），但是当我们需要实现类对象的时候，不需要自己new实现类对象，只需要到容器中去取实现类对象即可，也就是说实现类我们自己写好之后，要在容器中创建对应的实现类对象。所以现在我们要在配置文件中配置对应的实现类对象的路径。</p>
<p>IDEA为我们创建的原始的Spring配置文件如下：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411114058625.png" alt="image-20210411114058625" style="zoom:67%;" />

<p>里面有beans标签，我们需要为我们的实现类对象创建bean标签：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411114618680.png" alt="image-20210411114618680" style="zoom:67%;" />

<p>bean标签中的class选项对应的就是我们自己写的实体类，然后它会把实体类放入一个map集合中，真实的class就是实体类的值，这个id就相当于是一个键，每个id和class构成一个键值对。当我们需要这个实体类的对象的时候不用自己new，只需要引用这个id即可。</p>
<p>那么在test方法中我们需要实现类对象的时候我们该如何获取呢？首先要先创建一个容器：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411115837411.png" alt="image-20210411115837411"></p>
<p>使用ApplicationContext类来创建容器对象，参数里面传入我们配置文件的名称。</p>
<p>然后创建EmpDao接口对应的实现类对象时就不用new了，之间使用getBean方法，里面传入之前设置的id（里面其实可以传两个参数，如何后面那个参数你不传的话，前面就要进行一下强制类型转换），如果要传的话，就传”接口名.class”</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411120505808.png" alt="image-20210411120505808"></p>
<p>注意：对应的接口和实现类都要自己先写好。</p>
<h3 id="Spring-Ioc实现原理"><a href="#Spring-Ioc实现原理" class="headerlink" title="Spring_Ioc实现原理"></a>Spring_Ioc实现原理</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411125050065.png" alt="image-20210411125050065" style="zoom: 67%;" />

<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411124453642.png" alt="image-20210411124453642"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411125425987.png" alt="image-20210411125425987"></p>
<h3 id="Spring-Ioc和DI概念解释"><a href="#Spring-Ioc和DI概念解释" class="headerlink" title="Spring_Ioc和DI概念解释"></a>Spring_Ioc和DI概念解释</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411125730020.png" alt="image-20210411125730020" style="zoom: 67%;" />

<p>创建对象不用我们管，Spring来管。创建对象这一块是Ioc来管。那么对象的属性赋值谁来管呢？也是Spring来管，也就是说不用我们自己去调get/set方法去给对象赋值</p>
<p>实际开发中基于注解方式的Bean管理用得比较多。基于XML方式的Bean管是便于我们对下一步学习的理解。</p>
<h3 id="Spring-Bean标签属性简介"><a href="#Spring-Bean标签属性简介" class="headerlink" title="Spring_Bean标签属性简介"></a>Spring_Bean标签属性简介</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411132333568.png" alt="image-20210411132333568" style="zoom:67%;" />

<p>在XML配置文件中可以配置积极加载和懒加载。积极加载在初始化容器的时候就会调用new 对象的构造方法，懒加载则在初始化容器的时候不会初始化对象，必须要我们手动在容器中取出对象时它才会初始化对象。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411132939275.png" alt="image-20210411132939275"></p>
<p>bean标签还有一个属性值，就是scope，如果scope选择singleton，则每次创建相同的对象时都是从容器中取出相同的对象（取出两次相同的对象，检测结果两个对象为同一个），如果scope选择prototype，则取出相同的对象时会创建新的对象，不会直接取原来的对象。（在内存上指向不同的对象）</p>
<p>一般我们在开发项目的时候能用singleton就用这个，单例节省内存，不用重新创建对象。（在不涉及线程共享和线程安全时优先考虑）</p>
<p>普通的Java项目的scope只有这两个选项，一般的web项目的scope还有其它选项：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411133924798.png" alt="image-20210411133924798" style="zoom:60%;" />

<p>在创建完对象之后我们发现对象的属性是没有被赋值的，那么如何给这些属性赋值呢？请看下面一节。</p>
<h3 id="Spring-XML实现DI"><a href="#Spring-XML实现DI" class="headerlink" title="Spring_XML实现DI"></a>Spring_XML实现DI</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411134129501.png" alt="image-20210411134129501" style="zoom:70%;" />

<p>property name 后面对应的是实体类里面的属性名，value是我们赋的属性值（前提是你的实体类中要有set方法），那这样我们在初始化对象的时候Spring就会自动为我们调用类中的set方法为对象的属性赋值。</p>
<p>如果属性中有其它对象，则会用到ref标签（property中还有一个ref标签）</p>
<p>刚刚那个是通过get/set方法给实现类对象的属性赋值，如果想要通过构造方法给实体类对象的属性赋值的话，需要使用另一个标签来代替property：constructor-arg标签</p>
<p>注意：使用property方法设定属性的值可以不用全部设定，而如果要使用有参构造方法则必须将构造方法中指定的所有参数全部传入。index指的是参数的顺序，从0开始。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411151628643.png" alt="image-20210411151628643" style="zoom:67%;" />

<h5 id="通过p名称空间和c名称空间实现DI（给对象属性赋值）"><a href="#通过p名称空间和c名称空间实现DI（给对象属性赋值）" class="headerlink" title="通过p名称空间和c名称空间实现DI（给对象属性赋值）"></a>通过p名称空间和c名称空间实现DI（给对象属性赋值）</h5><p>为了简化上面两种写法，我们需要先启用p名称空间和c名称空间，在xml配置文件的开头加上这么灰色的两行，即可开启p名称空间和c名称空间：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411152020556.png" alt="image-20210411152020556" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411152252844.png" alt="image-20210411152252844" style="zoom:80%;" />



<h4 id="通过DI注入一些空值和特殊符号"><a href="#通过DI注入一些空值和特殊符号" class="headerlink" title="通过DI注入一些空值和特殊符号"></a>通过DI注入一些空值和特殊符号</h4><p>为成员属性赋值的时候一些特殊情况：</p>
<p>CDATA标签代表指定里面的内容是纯文本，不需要对特殊符号进行转义</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411152916695.png" alt="image-20210411152916695" style="zoom:70%;" />

<p>xml文件中的写法：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411153011934.png" alt="image-20210411153011934" style="zoom:67%;" />



<h4 id="类中成员变量有其它类时的bean——通过ref或嵌套bean"><a href="#类中成员变量有其它类时的bean——通过ref或嵌套bean" class="headerlink" title="类中成员变量有其它类时的bean——通过ref或嵌套bean"></a>类中成员变量有其它类时的bean——通过ref或嵌套bean</h4><p>现在有一个小老鼠类，小老鼠类里面有一个birthday属性，其类型为Date类型，我们在容器中添加这个对象时如果直接添加字符串形式的日期给birthday属性的话会出错，所以我们要往里面添加一个Date对象。那我们自己就需要先在容器中创建一个Date对象，然后让小老鼠对象进行ref引用。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411182243996.png" alt="image-20210411182243996" style="zoom: 80%;" />

<p>现在有一个cat类，里面有小老鼠类作为成员变量：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411183609282.png" alt="image-20210411183609282" style="zoom:67%;" />

<p>在容器中创建cat类的对象：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411183505818.png" alt="image-20210411183505818" style="zoom:73%;" />

<p>创建cat类对象时为Mouse成员变量赋值，直接ref引用上面的那只小老鼠，和小老鼠ref引用外部Date对象一样</p>
<p>在测试方法里面测试一波：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411183813715.png" alt="image-20210411183813715"></p>
<p>除了引用外部的bean之外，我们还可以直接直接在内部创建一个bean，然后再为内部的bean进行赋值（使用property标签）</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411184052245.png" alt="image-20210411184052245" style="zoom:75%;" />

<p>内部的bean中还可以再创建bean，这是一种内部的级联写法。</p>
<p>还有：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411184525113.png" alt="image-20210411184525113" style="zoom:80%;" />

<p>mouse2是老鼠名，mouse1是cat中的成员变量，当作mouse即可。</p>
<p>注意，使用mouse1.name的时候一定要保证mouse对象有name对应的get方法才行。</p>
<h4 id="使用DI为对象的属性赋值时，成员变量是List、Map等特殊类型的情况"><a href="#使用DI为对象的属性赋值时，成员变量是List、Map等特殊类型的情况" class="headerlink" title="使用DI为对象的属性赋值时，成员变量是List、Map等特殊类型的情况"></a>使用DI为对象的属性赋值时，成员变量是List、Map等特殊类型的情况</h4><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411203441191.png" alt="image-20210411203441191" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411203600349.png" alt="image-20210411203600349" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411203640006.png" alt="image-20210411203640006" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411203934072.png" alt="image-20210411203934072" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411203820707.png" alt="image-20210411203820707" style="zoom:67%;" />

<h3 id="Spring-bean工厂"><a href="#Spring-bean工厂" class="headerlink" title="Spring_bean工厂"></a>Spring_bean工厂</h3><p>我们提前创建好了一个Book类，现在创建一个生产Book的工厂，BookFactory类：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210411205728949.png" alt="image-20210411205728949" style="zoom:67%;" />

<p>工厂模式需要实现FactoryBean<T>接口，并重写其中的两个抽象方法。注意这个方法返回的是一个Book对象，而不是BookFactory对象，但是我们在容器的xml文件中配置的是工厂类，但返回的是Book类的对象。</p>
<h3 id="SpringBean的生命周期"><a href="#SpringBean的生命周期" class="headerlink" title="SpringBean的生命周期"></a>SpringBean的生命周期</h3><p>SpringBean的生命周期分为五步：(以在容器中放入的User对象为例)</p>
<p>如果此时我们要创建一个User的实体类对象，不需要自己创建，只需要从容其中获取。</p>
<ol>
<li>第一步：User构造（调用实体类中的构造方法）</li>
<li>第二步：User set方法，通过DI为属性赋值</li>
<li>第三步：User初始化，调用Userinit方法？</li>
<li>第四步：User获取，可以在测试方法中获取User并进行输出等操作</li>
<li>第五步：User销毁。User销毁会随着容器的关闭而销毁，如果我们想要手动关闭，调用application.close()方法即可。（一开始获取容器是通过application对象获取的，获取容器对象那一步）</li>
</ol>
<p>在User类中定义完相应的方法之后要在容器中告诉Bean各个方法对应的作用：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412125401146.png" alt="image-20210412125401146"></p>
<p>添加后置处理器：</p>
<p>如果我们想要在初始化之前和初始化之后对我们的Bean对象做出一些处理，我们需要额外写一个后置处理器类，并让它实现BeanPostProcessor接口，并重写其中的两个方法。然后要在容器中通过显式地去注册    后置处理器。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412125256913.png" alt="image-20210412125256913"></p>
<p>就算初始化方法没有，后置处理器也会在第三步的时候进行干预。</p>
<h3 id="Spring自动装配"><a href="#Spring自动装配" class="headerlink" title="Spring自动装配"></a>Spring自动装配</h3><p>当一个对象中的属性有其它对象时，我们想要在容器中添加这个对象，往往还要先添加其属性中包含的对象。那有没有方法可以自动帮我们添加其中包含的对象呢？通过autowire关键字，我们就可以让容器自动检测其中装有的对应的对象，并自动帮我们添加。（这样我们就不用通过property属性手动添加了，大妙）</p>
<p>autowire有两个选项可选：byName和byType</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412131924102.png" alt="image-20210412131924102" style="zoom:67%;" />

<p>byName要求在容器中被期望添加的对象与类中的对象名一致（要保证当前的属性值与目标id保持一致）</p>
<p>byType是根据数据类型，此时跟名字就没关系了。</p>
<p>注意，使用byType类型时目标类型在容器中只能有一个，否则bean不知道要装配哪一个：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412132410606.png" alt="image-20210412132410606" style="zoom:80%;" />



<h3 id="Spring-读取属性配置文件"><a href="#Spring-读取属性配置文件" class="headerlink" title="Spring_读取属性配置文件"></a>Spring_读取属性配置文件</h3><p>之前在MyBatis中讲过读取jdbc.properties属性配置文件并对其进行编辑，那么这个功能在Spring中是否可以实现呢？也可以。这样一种技术叫做数据库连接池技术。</p>
<p>阿里自己写的德鲁伊连接池性能很好。注意，以后连接池都不叫连接池了，叫数据源。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412133648044.png" alt="image-20210412133648044"></p>
<p>德鲁伊的依赖可以在mvnrepository.com去找（Druid），搜alibaba也可以。</p>
<p>然后通过maven导入对应的dependencies（jar包，里面有对应的class类），并在容器中添加其对应的bean。</p>
<p>在bean中需要通过property属性来配置类中的四个和数据连接有关的成员变量信息：username、password、url、driverClassName</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412150206342.png" alt="image-20210412150206342"></p>
<p>xml中双标签中间没有内容的可以直接写成单标签。</p>
<p>然后你会发现和之前一样，这些JDBC信息写在bean的配置文件中耦合度有点高了，所以我们最好把这些信息单独写在一个另外的jdbc.properties文件中，然后在bean容器配置文件中使用美元符+大括号引用即可。</p>
<p>容器的xml文件中：（加上jdbc前缀防止重名）</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412155427356.png" alt="image-20210412155427356" style="zoom:80%;" />

<p>jdbc.properties文件中：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412155505668.png" alt="image-20210412155505668"></p>
<h3 id="Spring-Ioc注解方式实现"><a href="#Spring-Ioc注解方式实现" class="headerlink" title="Spring_Ioc注解方式实现"></a>Spring_Ioc注解方式实现</h3><p>前面说的bean对象的创建和通过DI为属性赋值基本上都是通过xml文件实现的，但这在实际开发中其实不是很常用。实际开发中常用的是通过注解方式实现。下面来说一下：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412160048986.png" alt="image-20210412160048986" style="zoom:60%;" />

<p>上面那个是“但是不推荐”。。。</p>
<p>bean的xml文件中：添加context那一行</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412161556883.png" alt="image-20210412161556883"></p>
<p>相当于bean中直接就添加了左侧bean包里的两个类</p>
<p>然后在类上加上@Component注解即可在容器中成功地添加这个类，注解后面可以加括号，括号里写的就是test方法中获取的当前类的对象地名称，相当于之前的id。<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412162431825.png" alt="image-20210412162431825" style="zoom:50%;" /></p>
<p>test方法：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412162524947.png" alt="image-20210412162524947"></p>
<p>排除注解：（一般默认情况下四个注解都用，但也可以指定不识别某个特定注解）</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210412170320054.png" alt="image-20210412170320054"></p>
<p>比如上图就不会识别Controller注解，其它注解都可以识别。exclude是排除，include是包含（识别）。</p>
<h3 id="Spring-DI注解方式实现"><a href="#Spring-DI注解方式实现" class="headerlink" title="Spring_DI注解方式实现"></a>Spring_DI注解方式实现</h3><p>当容器中的对象想要引用容器中的另一个对象时（其成员属性中有一个对象），在其实体类中对应的成员变量的对象上加上@Autowired注解，则容器会自动寻找容器中是否已经有我们需要引用的对象，如果有会自动进行引用并给属性赋值。</p>
<p>比如service层里面有DAO对象，但是我们不能直接在service层或者其对应的方法中直接new一个DAO对象，因为这样就提高了两层之间的耦合度。那spring的目的就是把对象放入容器中从而降低耦合度，所以我们需要在容器中创建service类中的DAO类的对象（成员变量）。之前的方法是先在容器中创建好DAO层的对象，然后在service层的bean标签中的property标签里引用DAO层的对象。但是现在不用了，你只需要在service的实体类中的DAO成员变量上加上@Autowired注解，容器就会为我们自动添加，不用通过property标签添加。（但是还是要在容器中创建实体类对象，前面我们说过，我们可以直接在实体类上写@Component注解，从而让容器自动帮助我们创建对象，不用再自己去写bean标签。那DAO层的实体类上应该写的是@Repository注解（@Component的子注解，在数据库交互层使用），service层的实体类上写的应该是@service注解，同时service层的实体类中的DAO对象上又写了@property注解，这样他喵的我们在容器中啥都不用写😊。</p>
<p>DAO层实体类：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413113625783.png" alt="image-20210413113625783" style="zoom:67%;" />

<p>service层实体类：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413113522943.png" alt="image-20210413113522943" style="zoom: 67%;" />

<p>注意每一层都有一个接口，方法定义在接口中，实体类继承了接口之后重写其中的方法：（可以有多个同一层的多个实体类继承同一个接口）</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413113717511.png" alt="image-20210413113717511" style="zoom:67%;" />

<p>注意，如果上图中你DAO层的两个实现类A和B都添加了@Repository注解，那系统会报错，因为他不知道到底要new哪一个实体类的对象。</p>
<p>如果你想两个实体类都加@Repository注解，但可以指定调用其中一个类的对象，可以使用@Qualifier注解，可以通过名称去找，默认名称就是类名（首字母小写）：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413114520989.png" alt="image-20210413114520989" style="zoom:67%;" />

<p>也可以通过@Resource注解，可以直接添加指定类名：（相当于上面两个注解加起来），不加后面那个括号就相当于@Autowired</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413115206469.png" alt="image-20210413115206469" style="zoom:60%;" />

<p>但在实际开发中很少出现DAO层一个接口有两个实现类的，所以很少用名称去找，@Autowired用得较多。</p>
<p>因为@Autowired来自SpringFrameWork包，而@Resource来自javax包。Spring官方推荐是使用来自Spring的注解，这样可以降低Spring和JDK的耦合度。但是你想用@Resource注解也没问题。</p>
<p>使用@Value注解为可以直接成员变量赋值：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413120005504.png" alt="image-20210413120005504" style="zoom: 60%;" />

<p>使用字符串为Integer类型赋值系统会自动转换。但是这样赋值有弊端，就是这个值直接写死在这个类里面了，如果以后我们想要动态的读取和修改，就会很麻烦。</p>
<p>但是我们之前学过可以把这些玩意儿写在property配置文件中👨‍🚀，然后通过 ${} 进行引用，大妙啊。</p>
<p>先在容器中指定一下配置文件：（上面那一行）</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413121610991.png" alt="image-20210413121610991"></p>
<p>配置文件中的内容：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413121855895.png" alt="image-20210413121855895" style="zoom:67%;" />

<p>原来的类中成员变量上的@Value注解内容可以进行引用了：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413121807417.png" alt="image-20210413121807417" style="zoom:67%;" />

<p>注意，这里没有加前缀，但是最好还是加上，以免搞混（就像jdbc配置文件中的信息加了jdbc_前缀一样）</p>
<h3 id="配置类方式实现Ioc和DI"><a href="#配置类方式实现Ioc和DI" class="headerlink" title="配置类方式实现Ioc和DI"></a>配置类方式实现Ioc和DI</h3><p>前面已经说过，配置文件中几乎什么信息都不用写，除了包扫描信息和一些引用property文件的信息，那配置文件中内容这么少，其实配置文件可以不用写，我们可以用一个类，通过代码的提示来体现配置信息。</p>
<p>作为了解即可，我感觉还是配置文件香，反正代码量都是一样的少。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413123318519.png" alt="image-20210413123318519" style="zoom:67%;" />

<p>在配置类中用两个注解可以代替xml容器配置文件，又感觉有点香了，好简洁。注意，使用配置类最好新建一个Config文件夹然后把配置类都放这里面。</p>
<h3 id="Spring-代理模式概念和静态代理"><a href="#Spring-代理模式概念和静态代理" class="headerlink" title="Spring_代理模式概念和静态代理"></a>Spring_代理模式概念和静态代理</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413123900548.png" alt="image-20210413123900548"><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413124455110.png" alt="image-20210413124455110" style="zoom: 45%;" /></p>
<p>Aop就是通过代理模式来实现其具体功能的.</p>
<p>静态代理实际开发中几乎不用，而且麻烦不好用，增加工作量且效率低下。</p>
<p>代理的精髓就是我们想要使用一个对象，可以用另外一个对象来代理这个对象，并对其中的功能进行拓展和增强。当我们想要使用这个对象时可以直接使用它的代理对象，但是代理对象中有一部分功能时来自于原来的对象。</p>
<p>代理模式一共有三个组成部分：</p>
<ol>
<li>被代理的类</li>
<li>代理类</li>
<li>面向的或者要实现的接口</li>
</ol>
<h3 id="Spring-JDK动态代理"><a href="#Spring-JDK动态代理" class="headerlink" title="Spring_JDK动态代理"></a>Spring_JDK动态代理</h3><p>代理类在程序运行时才会创建的代理模式称为动态代理模式。在这种情况下，代理类并不是在Java代码中定义好的，而是在程序运行时根据我们在Java代码中的“指示”动态生成的。</p>
<p>这种动态代理有两种模式：</p>
<ol>
<li>JDK内置的Proxy动态代理——面向接口</li>
<li>cglib第三方动态代理——面向父类</li>
</ol>
<p>动态代理案例——张三吃饭</p>
<p>通过Proxy动态代理获得一个代理对象，在代理对象中，对某个方法进行增强</p>
<p>调用JDK中Proxy类的newProxyInstance()方法，此方法中传入三个参数：loader、interfaces、h</p>
<p>向上转型自动转，向下转型要强转。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413195534440.png" alt="image-20210413195534440"></p>
<p>我们在调用重写的抽象方法时系统会自动执行invoke方法，invoke方法中可以定义增强方法功能的代码</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413202959233.png" alt="image-20210413202959233"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413202809125.png" alt="image-20210413202809125"></p>
<p>JDK动态代理模式比较难理解，如果大家觉得不好理解的话，就先记住动态代理的定义即可</p>
<h3 id="Spring-cglib动态代理"><a href="#Spring-cglib动态代理" class="headerlink" title="Spring_cglib动态代理"></a>Spring_cglib动态代理</h3><p>子类直接继承来父类方法然后对父类方法进行功能重写，在new对象时new子类对象即可，这是cglib代理模式的底层逻辑。</p>
<p>cglib代理模式的执行步骤：</p>
<ol>
<li>获得一个Enhancer对象（专门用来生产代理对象的）</li>
<li>设置父类的字节码</li>
<li>获取MethodIntercepter对象，用于定义增强规则</li>
<li>获得代理对象</li>
<li>使用代理对象完成功能</li>
</ol>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413211456121.png" alt="image-20210413211456121"></p>
<p>获得代理对象之前再加一步：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413211644118.png" alt="image-20210413211644118"></p>
<p>cglib代理和jdk代理了解即可，因为这个已经到了写工具给别人用的阶段了，现在刚入门可以先基本了解一下。</p>
<h3 id="Spring-Aop术语解析"><a href="#Spring-Aop术语解析" class="headerlink" title="Spring_Aop术语解析"></a>Spring_Aop术语解析</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210413213313773.png" alt="image-20210413213313773"></p>
<ol>
<li>可以被增强的方法称为连接点，但是连接点不一定被增强</li>
<li>每一个切入点都是连接点，但连接点不一定是切入点</li>
</ol>
<h3 id="Spring-AOP项目准备"><a href="#Spring-AOP项目准备" class="headerlink" title="Spring_AOP项目准备"></a>Spring_AOP项目准备</h3><p>我们以一个DAO层的方法增强的案例来进行AOP的演示。</p>
<p>AspectJ 本身并不是spring框架中的组成部分，是一个独立的AOP框架，一般把 AspectJ 和spring框架的AOP依赖一起使用，所以要导入一个独立的依赖。</p>
<p>实现的两种方式：</p>
<ol>
<li>基于注解方式实现（熟练）</li>
<li>基于XML配置方式（了解）（实际开发中用的一般都是注解）</li>
</ol>
<p>还要导入一大堆jar包（通过maven的pom.xml配置文件导入依赖）</p>
<p>一共需要导入如下几个jar包：spring-aspects包、aopalliance包、commons-logging包、Junit包、Lombok包，如果需要连接数据库进行操作的话还可以导入Druid包和MySQL驱动包。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415121021646.png" alt="image-20210415121021646"></p>
<h3 id="Spring-AOP注解实现"><a href="#Spring-AOP注解实现" class="headerlink" title="Spring_AOP注解实现"></a>Spring_AOP注解实现</h3><p>AOP的功能就是用来增强方法的，和之前的动态代理一样。有@Before和@After，可以在你所需执行的方法的前后自己再定义功能，可以增强方法。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415122725296.png" alt="image-20210415122725296" style="zoom:67%;" />

<p>指定在addUser方法前运行此方法（注意，这个Aspect也需要使用@Component来在容器中创建对象</p>
<p>参数列表可以用JoinPoint接收切点对象</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415124316766.png" alt="image-20210415124316766" style="zoom:67%;" />

<p>后置通知无论切点方法是否出现异常，都会被执行：（也叫做最终通知）</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415124535795.png" alt="image-20210415124535795" style="zoom:67%;" />

<p>如何获得目标方法的返回结果呢？使用@AfterReturning。返回通知：在切点方法返回结果之后增强的功能</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415125602816.png" alt="image-20210415125602816" style="zoom:80%;" />

<p>如果切点方法出现异常则此方法不会执行（注意与@After方法的区别）</p>
<p>异常通知：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415131435358.png" alt="image-20210415131435358" style="zoom:67%;" />



<p>环绕通知：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415132930212.png" alt="image-20210415132930212" style="zoom:67%;" />

<p>注意，每个通知前面都有切点表达式，那我们可以把切点表达式给抽出来，定义一个公共切点：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415133125800.png" alt="image-20210415133125800" style="zoom:67%;" />



<p>下面的方法上注释可以改成这样：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415133151269.png" alt="image-20210415133151269" style="zoom:67%;" />

<p>公共切点execution中不建议写实现类，耦合度有点高，可以让它指向接口</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415133320134.png" alt="image-20210415133320134" style="zoom:67%;" />



<h4 id="JoinPoint对象和ProceedingJoinPoint对象"><a href="#JoinPoint对象和ProceedingJoinPoint对象" class="headerlink" title="JoinPoint对象和ProceedingJoinPoint对象"></a>JoinPoint对象和ProceedingJoinPoint对象</h4><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415134901125.png" alt="image-20210415134901125" style="zoom: 60%;" />





<h3 id="完全使用注解开发（使用配置类）"><a href="#完全使用注解开发（使用配置类）" class="headerlink" title="完全使用注解开发（使用配置类）"></a>完全使用注解开发（使用配置类）</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415135459180.png" alt="image-20210415135459180" style="zoom:67%;" />



<h3 id="Spring-AOP-XML实现"><a href="#Spring-AOP-XML实现" class="headerlink" title="Spring_AOP_XML实现"></a>Spring_AOP_XML实现</h3><p>这里系统解释一下切点和切面的区别。切点是什么呢？切点就是我们想要增强的某个方法。切面是什么呢？就是我们增强了方法之后添加的@Before、@After等等等等一大堆在被增强方法前后执行的所有方法。这些方法构成一个切面，而原来的最初的方法是切点。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415195316410.png" alt="image-20210415195316410"></p>
<h3 id="Spring-JdbcTemplate项目搭建"><a href="#Spring-JdbcTemplate项目搭建" class="headerlink" title="Spring_JdbcTemplate项目搭建"></a>Spring_JdbcTemplate项目搭建</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415200200747.png" alt="image-20210415200200747"></p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415200235344.png" alt="image-20210415200235344" style="zoom:50%;" />

<p>我们之前学的Ioc、DI是在Core部分，AOP和Aspects也学完了。现在学的这个JdbcTemplate是在左上方的Data AccessIntegration部分，后面这个部分会被MyBatis替代，但我们可以先学一下，还是好学的。我们可以使用其实现增删改查的功能。</p>
<p>先创建一个maven项目，喵的，又要导入一大堆jar包。</p>
<p>然后创建jdbc.properties属性配置文件，把username、password、connector、url等数据库连接配置信息放里面（前面说过，降低耦合度）</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415203200336.png" alt="image-20210415203200336" style="zoom:50%;" />

<p>然后创建applicationContext.xml配置文件（没错，就是我们的spring容器），然后配置如图的一堆信息。</p>
<p>JdbcTemplate和MyBatis功能是一样的。MyBatis对比JdbcTemplate优势明显。所以直接用MyBatis即可。</p>
<p>所以这个就先跳过了，后面直接整合MyBatis即可。</p>
<h3 id="Spring-事务回顾"><a href="#Spring-事务回顾" class="headerlink" title="Spring_事务回顾"></a>Spring_事务回顾</h3><p>我们的项目分为视图层、控制层、服务层、DAO层。事务和前两层没什么关系，主要是和服务层和DAO层有关系。DAO只封装数据的基本增删改查，不处理业务。Service专门处理业务，如果需要实现增删改查则通过DAO来影响数据库。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210415210232126.png" alt="image-20210415210232126"></p>
<p>我们需要在执行service方法之前开启事务，在执行service方法之后检测其是否正常结束。而这刚好跟我们之前学的AOP相关。前置通知、异常通知和后置通知。</p>
<h3 id="Spring-日志使用"><a href="#Spring-日志使用" class="headerlink" title="Spring_日志使用"></a>Spring_日志使用</h3><p>和mybatis一样，在maven项目的pom.xm核心配置文件中导入log4j2的依赖</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2021/03/21/Mybatis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/03/21/Mybatis/" class="post-title-link" itemprop="url">Mybatis详解</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-03-21 11:54:46 / Modified: 17:23:39" itemprop="dateCreated datePublished" datetime="2021-03-21T11:54:46+08:00">2021-03-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/computer/" itemprop="url" rel="index"><span itemprop="name">computer</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2021/03/21/Mybatis/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2021/03/21/Mybatis/" class="cy_cmt_count" data-xid="2021/03/21/Mybatis/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>7.8k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>7 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h2><h3 id="Mybatis的项目搭建"><a href="#Mybatis的项目搭建" class="headerlink" title="Mybatis的项目搭建"></a>Mybatis的项目搭建</h3><p>但凡是框架，使用都是分三步走：</p>
<ol>
<li>导入jar文件，使用maven</li>
<li>处理配置文件</li>
<li>开发业务代码</li>
</ol>
<h5 id="1-创建maven项目"><a href="#1-创建maven项目" class="headerlink" title="1.创建maven项目"></a>1.创建maven项目</h5><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407132103248.png" alt="image-20210407132103248"></p>
<p>注意之前设置maven的时候要把你用的maven覆盖掉idea原有的maven，同时配置文件和本地仓库位置也要自己配置一下。</p>
<p>创建完一个maven项目之后需要导入如下的依赖：（在mvnrepository.com）中去搜索对应的依赖。总共四个依赖：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407133128215.png" alt="image-20210407133128215"></p>
<p>注意其中的scope标签，表示的是你这个依赖的范围。Junit是在测试的时候用的，所以它的scope是test。</p>
<p>lombok的scope是provided，因为Lombok就是在编译的时候需要使用一下</p>
<h5 id="2-处理配置文件"><a href="#2-处理配置文件" class="headerlink" title="2.处理配置文件"></a>2.处理配置文件</h5><p><strong>1.准备数据库，包结构和实体类：</strong></p>
<p>先在IDEA中创建一个maven项目，下面这个是mybatis的项目结构：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408090551255.png" alt="image-20210408090551255" style="zoom:67%;" />



<p>我们需要做的就是在Java目录下创建自己域名的包，然后在包下创建两个文件夹：mapper和pojo。</p>
<p><strong>2.准备mapper映射文件和核心配置文件</strong></p>
<p>我们知道第二个大步骤是处理核心配置文件，那么mybatis有哪些配置文件呢？如下图：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408091425065.png" alt="image-20210408091425065"></p>
<p>首先是SqlMapConfig.xml配置文件，一些URL、Driver、UserName和Password等信息都往这里面放，它下面要关联一系列的Mapper映射文件，每一个mapper映射文件对应一个数据库表，比如Dept表，每一个数据库表我们要做的增删改查操作都放在mapper映射文件里面。那么如何配置这两个配置文件呢？</p>
<p>在mybatis官网的入门教程中可以查到这么一段配置代码：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408092022337.png" alt="image-20210408092022337" style="zoom:50%;" />

<p>放在项目的resources资源目录下，在resources目录下创建sqlMapConfig.xml文件，把上面这段代码粘进去。创建了xml后IDEA会默认为我们在文档顶部生成一段文档约束，不用去管，也不要删掉。</p>
<p>我们需要更改里面的四个property选项，注意，在xml文档中写url的时候会用到&amp;符号，但是在是在xml和html文档中写这些符号都需要在符号后面跟上一个转义符amp;才可以，也就是说&amp;才代表了一个完整的&amp;符号。</p>
<p>在mapper文件夹下创建DeptMapper.xml文件，去mybatis官网里面把mapper的映射代码粘进来，mapper文件夹下应该还要有一个名为DeptMapper的接口，然后我们要保证项目编译之后xml文件和其对应的接口要放在同一个包中</p>
<p>上面的mapper对应的路径也要改一下</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408094725451.png" alt="image-20210408094725451" style="zoom:70%;" />

<p>DeptMapper.xml文件中的内容如下：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408111143668.png" alt="image-20210408111143668" style="zoom:70%;" />

<p>然后我们需要在pojo文件夹下创建数据库表对应的实体类，实体类名字要与数据库表名保持一致，实体类要实现序列化（Serializable）接口，在实体类中需要添加对应列名的属性，并提供相应的get、set方法以及构造方法。</p>
<p>但是！but！<img src="file:///C:\Users\xiaoqiyao\Documents\Tencent Files\1220883974\Image\C2C\92AA8D022A50F6B0C5FB24AFD774A79C.gif" alt="img" style="zoom:15%;" />在我们使用了Lombok之后，我们可以直接写一个小注解，然后Lombok会自动帮我们生成对应的get、set和对应的构造方法！注解格式如下：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408100129365.png" alt="image-20210408100129365"></p>
<p>注意：在mybatis中DAO层统一改为mapper层，意思就是连接数据库那一层，里面会写一些SQL的增删改查代码以及Java代码。</p>
<h3 id="Mybatis运行测试"><a href="#Mybatis运行测试" class="headerlink" title="Mybatis运行测试"></a>Mybatis运行测试</h3><p>在原生的JDBC中，我们查询数据库内容可能要写一大堆代码，还要配置什么Driver、Connector等等，但是在mybatis中只需要像下面这样写：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408101941785.png" alt="image-20210408101941785" style="zoom:50%;" />

<p>那这些都准备完了之后，我们要如何对数据库进行增删改查呢？通过一个sqlSession对象，也叫sql会话对象。</p>
<p>下面你将看到的，是一幅比较乱的图，我来一一解释：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408102812343.png" alt="image-20210408102812343"></p>
<p>我们需要一个sqlSession对象来对数据库进行增删改查，session就像是一个生产线，那么生产线从哪里来？需要一个工厂，也就是SqlSessionFactory，工厂从哪里来？需要工人来修，工人就是SqlSessionFactoryBuilder，工人的build方法中需要传入一个IO流对象，这个reader对象就是sqlMapConfig.xml文件，就像是建造工厂的一个图纸一样。IO流怎么获得呢？通过一个Resources类获得，返回一个</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408104907354.png" alt="image-20210408104907354"></p>
<p>在Test方法之前和之后可以添加@Before和@After注解，分别在@Test方法的之前和之后自动执行</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408110822498.png" alt="image-20210408110822498" style="zoom: 67%;" />

<p>把close方法放到@After方法中：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408110747360.png" alt="image-20210408110747360" style="zoom:67%;" />



<h3 id="Mybatis日志配置"><a href="#Mybatis日志配置" class="headerlink" title="Mybatis日志配置"></a>Mybatis日志配置</h3><p>我们想要像navicat那样看一下数据库运行的日志细节，这个时候我们在IDEA中就需要额外的一个日志了，否则我们只能看到运行结果</p>
<p>我们需要在整个项目的pom.xml配置文件中去添加日志的依赖。依赖到mvnrepository.com里面去找，直接搜log4j即可</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408111716735.png" alt="image-20210408111716735" style="zoom:50%;" />

<p>弄完之后import changes（IDEA右下角的小弹窗）：<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408111754609.png" alt="image-20210408111754609" style="zoom:67%;" /></p>
<p>然后我们需要在resources的根目录下创建一个这样的文件：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408111924609.png" alt="image-20210408111924609" style="zoom:50%;" />

<p>里面要粘的内容如下：（可以百度到）</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408112007194.png" alt="image-20210408112007194" style="zoom:67%;" />

<p>日志打印分为四个级别：<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408112104822.png" alt="image-20210408112104822"></p>
<p>debug是最细的一种。所以我们只需要在项目中添加一个依赖，再添加一个log4j.properties文件即可</p>
<p>注意，上面用的是log4j版本1，如果你导入的是log4j的版本2的依赖，创建的文件如下：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408112852044.png" alt="image-20210408112852044" style="zoom:80%;" />

<p>文件名为：log4j2.xml</p>
<h3 id="Mybatis其它配置"><a href="#Mybatis其它配置" class="headerlink" title="Mybatis其它配置"></a>Mybatis其它配置</h3><p>（注意：以下配置都是在sqlMapConfig.xml里面配置）</p>
<p>1.关于事务的配置</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408113952228.png" alt="image-20210408113952228"></p>
<p>把JDBC改成MANAGED，我们其实不用设置这个，后面会全部托管给Spring</p>
<p>2.mapper加载映射文件</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408114621638.png" alt="image-20210408114621638"></p>
<p>这个后面再讲，讲到代理模式的时候会讲</p>
<p>3.指定类型别名</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408114545813.png" alt="image-20210408114545813"></p>
<p>可以省去一些包名，不用每次都写一大堆路径</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408115109812.png" alt="image-20210408115109812" style="zoom:67%;" />

<p>那如果有100个类呢？每个类都要这样写一大行，那不是太多了？可以使用包扫描来起别名：（格式如下）</p>
<p>别名规则就是类的首字母小写</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408115212844.png" alt="image-20210408115212844"></p>
<h3 id="Mybatis引入外部属性配置文件"><a href="#Mybatis引入外部属性配置文件" class="headerlink" title="Mybatis引入外部属性配置文件"></a>Mybatis引入外部属性配置文件</h3><p>之前在核心配置文件中配置了四个和MySQL有关的信息，和mybatis的核心配置耦合度太高，其实这四个信息可以放在其它地方。这样每个配置文件的功能都比较单一，这样要好一点。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408115838593.png" alt="image-20210408115838593"></p>
<p>在resources下新建一个properties属性的配置文件：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408120011998.png" alt="image-20210408120011998"></p>
<p>内容如下：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408120246649.png" alt="image-20210408120246649"></p>
<p>用户名和密码写你自己的。</p>
<p>在mybatis核心配置文件中添加下面这段：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408120609958.png" alt="image-20210408120609958" style="zoom:50%;" />

<p>原来的属性改成这样即可：（花括号里的名称与jdbc配置文件里面的名称对应）</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408120641096.png" alt="image-20210408120641096" style="zoom:67%;" />

<p>注意，jdbc.properties里面不要有空格。当内外都配置了driver的时候，外部配置文件中的配置优先。（引入了外部文件，内部就没必要写了）</p>
<p>jdbc配置文件中建议加一下前缀，因为其它配置文件中可能也会有username和password：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408121128970.png" alt="image-20210408121128970"></p>
<p>（美元符和大括号里面也改一下）</p>
<h3 id="sqlSession三种查询方法"><a href="#sqlSession三种查询方法" class="headerlink" title="sqlSession三种查询方法"></a>sqlSession三种查询方法</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408122523517.png" alt="image-20210408122523517"></p>
<p>现在来说一下跳过的pojo和DAO</p>
<p>pojo里面存放的是和数据库表所对应的实体类对象，DAO里面存放的是对数据库进行的增删改查操作。</p>
<p>在pojo中创建数据库表的实体类，并把表中的列信息创建为属性，并提供相应的get、set以及构造方法（用Lombok注解）</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408123225242.png" alt="image-20210408123225242"></p>
<p>现在我想对这个数据库进行增删改查，所以要在mapper里面进行一些操作：（mapper就是DAO）</p>
<p>那么我们要在mapper里面进行哪些操作呢？我们可以定义一个方法：**(第一种，查询单个对象)**</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408124619028.png" alt="image-20210408124619028"></p>
<p>在mapper中这个select标签就相当于是定义了一个方法，id就是方法名，标签里面写我们的SQL语句resultType就是返回值类型，返回的是一个emp对象（员工信息，在pojo里面有对应的实体类）。</p>
<p>parameterType是参数类型</p>
<p>注意，你写完一个新的mapper文件之后要在核心配置文件里面加载以下新的mapper文件：（把Emp加上了）</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408125104221.png" alt="image-20210408125104221" style="zoom:67%;" />

<p>在测试类中调用上面mapper文件里面定义的方法：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408125155544.png" alt="image-20210408125155544" style="zoom:60%;" />

<p><strong>第二种：使用List查询多个对象</strong></p>
<p>这个是mapper里面对应的新定义的查询多个对象的方法：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408125702090.png" alt="image-20210408125702090" style="zoom:60%;" />

<p>测试查询多个对象：（下面这个注释写错了，是查询多个对象，不用在意）</p>
<p>下面那个foreach也可以直接用增强for(emp.for+回车即可)，这种foreach写法稍稍结合了一点lambda表达式和函数引用</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408125606945.png" alt="image-20210408125606945" style="zoom:50%;" />



<p><strong>第三种：使用Map查询多个对象，将数据库里的主键作为Map中的键</strong></p>
<p>上面的是返回多个对象的List集合，下面来看一下返回多个对象的Map集合：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408153434393.png" alt="image-20210408153434393" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408153255670.png" alt="image-20210408153255670" style="zoom:67%;" />



<h3 id="sqlSession三种参数传递"><a href="#sqlSession三种参数传递" class="headerlink" title="sqlSession三种参数传递"></a>sqlSession三种参数传递</h3><p>我们刚刚讲的这些查询都是没有参数的，但我们知道SQL语句中有些时候是有参数传递的，下面来讲一下如何传递参数。</p>
<p><strong>单个参数的情况：</strong></p>
<p>这个是mapper文件中的代码：（说明都在注释里）</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408161934193.png" alt="image-20210408161934193"></p>
<p>test方法中：前面传方法名，后面传参数</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408160858630.png" alt="image-20210408160858630"></p>
<p>上面是单个参数传递，下面看多个参数传递：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408163610173.png" alt="image-20210408163610173" style="zoom:70%;" />

<p><strong>参数是一个map集合</strong>：</p>
<p>&amp;gt代表xml中的大于符号（great than）小于符号是&amp;lt分号，大于等于是&amp;gt分号=，小于等于同理。</p>
<p>对应的test方法：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408163948331.png" alt="image-20210408163948331" style="zoom:70%;" />

<p>查询结果如下：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408164234594.png" alt="image-20210408164234594"></p>
<p><strong>参数为一个对象：</strong></p>
<p>上面的两个参数为deptno和sal，那我也可以直接传一个emp对象进去，然后从emp对象身上去取这两个属性出来。</p>
<p>arg是参数的意思，args意思就是多个参数。get和set方法Lombok已经写过注解了，此处可以直接调用。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408164944898.png" alt="image-20210408164944898" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408164828482.png" alt="image-20210408164828482" style="zoom:70%;" />



<h3 id="sqlSession实现CRUD"><a href="#sqlSession实现CRUD" class="headerlink" title="sqlSession实现CRUD"></a>sqlSession实现CRUD</h3><p>查询方法刚刚说过了，增删改还没说。增删改方法的返回值类型都是int，但是在这里没有resultType，否则报错。parameterType可以不写（之前说过）</p>
<p>增加数据方法：</p>
<p>注意，这边增加完数据需要手动提交一下事务，不然mybatis是默认回滚的，数据不会有变化。（增删改都需要手动提交事务）或者在@Before的方法中设置一个true，为自动提交。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408172721671.png" alt="image-20210408172721671"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408173153877.png" alt="image-20210408173153877"></p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408173042336.png" alt="image-20210408173042336" style="zoom:67%;" />



<p>修改数据：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408173545403.png" alt="image-20210408173545403" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408173456902.png" alt="image-20210408173456902" style="zoom:67%;" />

<p>删除数据：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408173854827.png" alt="image-20210408173854827" style="zoom:67%;" /><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408173913847.png" alt="image-20210408173913847"><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408173854827.png" alt="image-20210408173854827" style="zoom:67%;" /><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408173913847.png" alt="image-20210408173913847"></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408173913847.png" alt="image-20210408173913847"></p>
<h3 id="Mybatis基于接口代理模式开发"><a href="#Mybatis基于接口代理模式开发" class="headerlink" title="Mybatis基于接口代理模式开发"></a>Mybatis基于接口代理模式开发</h3><p>先把你要对数据库进行的操作的方法全部定义在一个接口里面，定义为抽象方法</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408180310269.png" alt="image-20210408180310269"></p>
<p>在接口的<strong>同级目录下</strong>创建一个对应的mapper文件，内容如下：（mapper.xml文件里面实现了接口里面定义的抽象方法：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408181432291.png" alt="image-20210408181432291"></p>
<p>maven有一个缺点，就是整个蓝色的Java目录下只编译Java文件，不编译xml文件。人家这么设定的原因就是想让我们把代码和目录文件分开。在resources目录下创建一个同名路径，然后把配置文件放进去。创建的时候一步一步创建，不要写带点的包名，否则会被识别为一个包。（其实后面学SpringBoot的时候配置文件和Java文件编译之后可以不用在同级目录下，后面再说）</p>
<p>涨知识：IDEA有时候编译项目的时候会误报，此时我们可以按CTRL+alt+shift+H将编译级别调低，就不会误报了。（不过我不太想调低）</p>
<p>测试类中的代码：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408182428691.png" alt="image-20210408182428691" style="zoom:67%;" />

<p>这个接口不用我们自己去写实现类，mybatis会自动帮我们生成实现类，我们可以直接调用里面的方法，这个方法就是我们在mapper中重写的方法。</p>
<p>别忘了新写完一个mapper后要在核心配置文件中添加mapper的映射：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210408182906081.png" alt="image-20210408182906081" style="zoom:80%;" />

<p>我们发现，这个方法完全是我们自己定义的方法，没有用sqlSession对象中的update哪些方法，耦合度降低了。到后面耦合度会更低，sqlSession对象直接看不到了，直接用mapper去调findAll方法。框架真香。</p>
<h3 id="MyBatis接口代理下的参数问题"><a href="#MyBatis接口代理下的参数问题" class="headerlink" title="MyBatis接口代理下的参数问题"></a>MyBatis接口代理下的参数问题</h3><p>定义两个方法，一个是根据empno去寻找员工，另一个是根据员工编号和薪资下限寻找员工。</p>
<p>注意，下面两个定义的方法海阳老师是写了文档注释的，一般定义接口中的抽象方法都是要写文档注释的，这是开发中的好习惯。</p>
<p>EmpMapper.java文件中定义的抽象方法（蓝色小鸟）：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410090844285.png" alt="image-20210410090844285" style="zoom:60%;" />

<p>那么我们要为这两个我们要实现的方法写SQL语句</p>
<p>EmpMapper.xml文件中重写的方法（红色小鸟，注意两个文件要同名噢）</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410090418475.png" alt="image-20210410090418475" style="zoom:70%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410091710629.png" alt="image-20210410091710629" style="zoom:67%;" />

<p>arg0，arg1这些代表的就是test方法里面传来的参数（按顺序）</p>
<p>也可以使用param* ，param1，param2…（从1开始）</p>
<p>test文件中的测试方法：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410091710629.png" alt="image-20210410091710629" style="zoom:67%;" />

<p>还可以在接口中给参数起别名：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410092208716.png" alt="image-20210410092208716" style="zoom:67%;" />

<p>注意：起了别名之后arg* 不能使用，param* 可以使用</p>
<p>上面的empno应该是deptno，写错了。</p>
<h3 id="MyBatis模糊查询"><a href="#MyBatis模糊查询" class="headerlink" title="MyBatis模糊查询"></a>MyBatis模糊查询</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410095400865.png" alt="image-20210410095400865" style="zoom:80%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410095707225.png" alt="image-20210410095707225" style="zoom:70%;" />

<p>这个字母a会作为参数传入到Java文件的接口的抽象方法中，抽象方法再调用xml文件里重写的SQL语句对数据库进行增删改查。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410095835292.png" alt="image-20210410095835292" style="zoom:67%;" />

<p>这样查就会出错哦。把ename那里改一下：</p>
<p>改成<code>like concat (&#39;%&#39;, #&#123;ename&#125;, &#39;%&#39;)</code> 里面不要有多余的空格。</p>
<h3 id="Mybatis主键自增回填"><a href="#Mybatis主键自增回填" class="headerlink" title="Mybatis主键自增回填"></a>Mybatis主键自增回填</h3><p>这种细碎使用技巧和知识点比较多。</p>
<h3 id="Mybatis接口代理CURD"><a href="#Mybatis接口代理CURD" class="headerlink" title="Mybatis接口代理CURD"></a>Mybatis接口代理CURD</h3><p>展示一些DML的操作。快速了解一下即可。该讲的前面都讲了。</p>
<h3 id="动态SQL之if"><a href="#动态SQL之if" class="headerlink" title="动态SQL之if"></a>动态SQL之if</h3><p>动态SQL是MyBatis框架中非常好用的一个功能。</p>
<p>Java接口类和test方法中都是正常写，就是xml文件中的SQL语句部分有一些变化。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410105800527.png" alt="image-20210410105800527" style="zoom: 67%;" />

<h3 id="动态SQL之where和when"><a href="#动态SQL之where和when" class="headerlink" title="动态SQL之where和when"></a>动态SQL之where和when</h3><p>把where 1=1 改成一个<where></where>标签。</p>
<p>有了where标签就可以去掉 if 中的第一个and</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410110524674.png" alt="image-20210410110524674" style="zoom:67%;" />

<p>或者把 if 结构换成 choose - when 结构：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410110703867.png" alt="image-20210410110703867" style="zoom:67%;" />



<h3 id="动态SQL之SET"><a href="#动态SQL之SET" class="headerlink" title="动态SQL之SET"></a>动态SQL之SET</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410111645737.png" alt="image-20210410111645737" style="zoom:67%;" />

<h3 id="动态SQL之TRIM"><a href="#动态SQL之TRIM" class="headerlink" title="动态SQL之TRIM"></a>动态SQL之TRIM</h3><p>set 和 where相当于是trim的特殊情况</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410112944408.png" alt="image-20210410112944408" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410112859331.png" alt="image-20210410112859331" style="zoom:67%;" />

<h3 id="动态SQL之BIND"><a href="#动态SQL之BIND" class="headerlink" title="动态SQL之BIND"></a>动态SQL之BIND</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410113325004.png" alt="image-20210410113325004" style="zoom:67%;" />

<h3 id="动态SQL之SQL"><a href="#动态SQL之SQL" class="headerlink" title="动态SQL之SQL"></a>动态SQL之SQL</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410114519740.png" alt="image-20210410114519740" style="zoom: 80%;" />

<p>直接用sql id 上面那一段那种写法，可以省去下面的很多代码，下面写SQL想写上面那一大堆查询语句时，直接 “include refid=标签” 即可。</p>
<h3 id="动态SQL之foreach"><a href="#动态SQL之foreach" class="headerlink" title="动态SQL之foreach"></a>动态SQL之foreach</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410120128102.png" alt="image-20210410120128102" style="zoom:70%;" />

<p>哇噢，看不懂。懂了。就是你要查多个员工的数据，你传入的是多个empno参数，然后你要在xml文件中把这些参数用foreach遍历一下。</p>
<h3 id="手动处理映射关系"><a href="#手动处理映射关系" class="headerlink" title="手动处理映射关系"></a>手动处理映射关系</h3><p> 当你实体类中的属性名和数据库的列名不一致的时候，要使用resultMap来处理一下。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410141755126.png" alt="image-20210410141755126" style="zoom:67%;" />

<h3 id="Mybatis多表查询"><a href="#Mybatis多表查询" class="headerlink" title="Mybatis多表查询"></a>Mybatis多表查询</h3><h4 id="一对一关联查询"><a href="#一对一关联查询" class="headerlink" title="一对一关联查询"></a>一对一关联查询</h4><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410143034506.png" alt="image-20210410143034506"></p>
<p>看到了这个目录结构，感觉还蛮重要的，可以说一下。蓝色的Java文件夹下存放的是Java代码，其下又分为两个文件夹：mapper和pojo。pojo里面放的是数据库表对应的实体类，mapper里面存放的是要执行SQL的接口，里面定义了抽象方法。</p>
<p>比如现在你要查emp员工的一大堆信息，要求还要查询员工的部门。但是resultType只会去emp类的属性里面去找结果类型，所以现在你要在emp的实体类中加入一条dept属性。同时要在其对应的mapper映射文件中加入一个association标签，代表这是一个关联属性。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410150305312.png" alt="image-20210410150305312" style="zoom:67%;" />

<p>手动处理映射的意义是什么呢？之前我们在mapper文件中定义方法时都可以定义resultType，但是resultType只能指定一种类型。当我们想要返回多种类型时，就需要手动处理映射，使用resultMap。</p>
<p>比如我想要查询一个部门中的一些员工信息，还有这个部门的编号和地理位置等，此时我是根据部门来查，但是其中会返回员工信息。</p>
<p>在部门的实体类中定义完自身属性之后，再定义一个存放员工的list集合：</p>
<p>在mapper映射文件c中重写方法，并将返回值类型设置为resultMap，并自己定义resultMap的映射关系。</p>
<p>collection代表的是一个集合，ofType指的是集合里的元素类型。collection会把在它下面定义的resultMap放入自身集合中。</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410154331669.png" alt="image-20210410154331669"></p>
<p>resuleMap就填写上面的deptJoinEmps</p>
<p>Test方法：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410154025662.png" alt="image-20210410154025662" style="zoom:67%;" />

<h4 id="一对多关联查询"><a href="#一对多关联查询" class="headerlink" title="一对多关联查询"></a>一对多关联查询</h4><p>一个部门返回多个员工，一对多</p>
<h4 id="多对多关联查询"><a href="#多对多关联查询" class="headerlink" title="多对多关联查询"></a>多对多关联查询</h4><p>这个其实好解释，前两个你会了这个你也就会了。通过project表查询正在进行的项目，里面有projectID表中的部分属性，同时projectID中有emp中的部分属性（比如empno），这样想查询哪些员工做了哪些项目就可以通过project一层一层地进行查询。</p>
<p>那结果集是怎么封装的呢？首先返回一个project对象，一个project类里面有一个list集合属性，这个集合里面装地时projectID对象，同时每个projectID对象里面又有emp属性，里面装的是emp对象（一对一）。</p>
<p>所以这个映射是先一对多，然后一对一。</p>
<p>一对多用collection，一对一用association</p>
<p>Java接口文件：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410161206393.png" alt="image-20210410161206393" style="zoom:67%;" />

<p>mapper.xml文件：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410162018095.png" alt="image-20210410162018095" style="zoom:67%;" />

<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410162123507.png" alt="image-20210410162123507" style="zoom:67%;" />

<p>总结：多对多表的关系的转换需要一个中间表来处理，会转化成一些一对多和一对一</p>
<p>test方法：</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410162526775.png" alt="image-20210410162526775" style="zoom:67%;" />

<p>注意，Emp实体类里面记得用Lombok注解添加构造方法和get、set方法！</p>
<h3 id="多表查询-级联积极加载"><a href="#多表查询-级联积极加载" class="headerlink" title="多表查询_级联积极加载"></a>多表查询_级联积极加载</h3><p>就是在定义collection的时候附加上一些属性。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410165203754.png" alt="image-20210410165203754" style="zoom:67%;" />

<p>select是你在往collection里放入元素的时候要调用的另一个方法。javaType是你collection的类型，column是你要往collection里放的元素，jdbcType是放入的元素类型，fetchType是加载类型，有积极加载和懒加载两种模式</p>
<h3 id="多表查询-级联懒加载"><a href="#多表查询-级联懒加载" class="headerlink" title="多表查询_级联懒加载"></a>多表查询_级联懒加载</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410165933824.png" alt="image-20210410165933824" style="zoom:67%;" />



<h3 id="MyBatis使用注解完成CRUD"><a href="#MyBatis使用注解完成CRUD" class="headerlink" title="MyBatis使用注解完成CRUD"></a>MyBatis使用注解完成CRUD</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410171438221.png" alt="image-20210410171438221" style="zoom:67%;" />

<p>直接在接口的抽象方法上@select即可指定此抽象方法要执行的查询语句，就不用在其对应的mapper映射文件中再写SQL了。当然，需要频繁改动的SQL最好还是在mapper里写，方便修改。但是有些固定的SQL语句可以使用注解来写，简化mapper里面的代码。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410171749896.png" alt="image-20210410171749896" style="zoom:60%;" />

<p>这些SQL相对来说功能都比较固定，修改可能性不大。</p>
<h3 id="Mybatis一级缓存"><a href="#Mybatis一级缓存" class="headerlink" title="Mybatis一级缓存"></a>Mybatis一级缓存</h3><p>缓存可以使连接数据库查询的次数变低。比如现在我要根据empno=7521来查询一个员工信息，一般mybatis会以键值对的形式来进行缓存。就是把emp作为键key，7521作为值value，存储在mybatis缓存中。这样下次查询7521员工信息的时候，就会直接从自身缓存中提出信息，而不会连接数据库进行多一次的查询。注意，缓存信息是存储在sqlSession中，如果你用两个sqlSession查询同一个数据，MyBatis还是会连接数据库进行查询。</p>
<p>调用sqlSession.commit()方法时会自动清空缓存。（事务提交时情空缓存，避免增删改造成的缓存不一致问题）只有增删改的时候需要手动提交事务。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410175725126.png" alt="image-20210410175725126" style="zoom:67%;" />

<h3 id="Mybatis二级缓存"><a href="#Mybatis二级缓存" class="headerlink" title="Mybatis二级缓存"></a>Mybatis二级缓存</h3><p>二级缓存可以实现跨sqlSession之间的共享数据，是在sqlSession之外的一个缓存空间。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410174712050.png" alt="image-20210410174712050" style="zoom:67%;" />

<p>二级缓存默认并不开启，需要我们手动设置开启。<strong>注意：sqlSession必须提交之后，相关数据才会放入二级缓存。</strong></p>
<p>二级缓存要求实体类必须实现序列化接口。并且可以把这些序列化的数据放入到其它位置，比如本地磁盘，Redis数据库等等。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410175927172.png" alt="image-20210410175927172" style="zoom:67%;" />

<h3 id="Mybatis三方缓存（了解）"><a href="#Mybatis三方缓存（了解）" class="headerlink" title="Mybatis三方缓存（了解）"></a>Mybatis三方缓存（了解）</h3><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410180027734.png" alt="image-20210410180027734" style="zoom:60%;" />

<p>反正就是借助第三方数据库进行缓存，包括著名的Redis，但是这个现在用不到，因为是分布式的时候用的。</p>
<h3 id="Mybatis逆向工程（了解）"><a href="#Mybatis逆向工程（了解）" class="headerlink" title="Mybatis逆向工程（了解）"></a>Mybatis逆向工程（了解）</h3><p>自己查文档。这个好用的，自动帮你生成基础的SQL、mapper配置文件、实体类和接口这些。</p>
<h3 id="Mybatis配置文件编译问题（IDEA的小坑）"><a href="#Mybatis配置文件编译问题（IDEA的小坑）" class="headerlink" title="Mybatis配置文件编译问题（IDEA的小坑）"></a>Mybatis配置文件编译问题（IDEA的小坑）</h3><p>在Maven中添加一个插件，可以直接把xml配置文件放在蓝色Java目录下，和对应的同名接口Java文件放在一起，这样比较科学，就不用在resources目录下一级一级地去建对应的目录然后把xml文件放进去了。要导入一个依赖，这个依赖自己去网上查代码，添加到mybatis的核心配置文件中即可。</p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210410181723525.png" alt="image-20210410181723525" style="zoom:67%;" />

<p>其实有些时候配置文件和Java代码放一块看着也挺杂的，Maven其实是建议我们把配置文件和Java代码分开放的。</p>
<p>MyBatis终于肝完了，NICE！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2020/11/29/Maven/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/29/Maven/" class="post-title-link" itemprop="url">Appache Maven</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-29 11:54:46" itemprop="dateCreated datePublished" datetime="2020-11-29T11:54:46+08:00">2020-11-29</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2020-12-09 17:23:39" itemprop="dateModified" datetime="2020-12-09T17:23:39+08:00">2020-12-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/computer/" itemprop="url" rel="index"><span itemprop="name">computer</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2020/11/29/Maven/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2020/11/29/Maven/" class="cy_cmt_count" data-xid="2020/11/29/Maven/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>1.1k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h2><h4 id="1-配置Maven一般要配置三个部分：本地仓库，镜像仓库，JDK版本（在users-m2-settings-xml）中进行配置。"><a href="#1-配置Maven一般要配置三个部分：本地仓库，镜像仓库，JDK版本（在users-m2-settings-xml）中进行配置。" class="headerlink" title="1.配置Maven一般要配置三个部分：本地仓库，镜像仓库，JDK版本（在users/.m2/settings.xml）中进行配置。"></a>1.配置Maven一般要配置三个部分：本地仓库，镜像仓库，JDK版本（在users/.m2/settings.xml）中进行配置。</h4><h4 id="2-Maven工程分类："><a href="#2-Maven工程分类：" class="headerlink" title="2.Maven工程分类："></a>2.Maven工程分类：</h4><ol>
<li>POM工程，POM工程是逻辑工程，用在父级工程或聚合工程中，用来做jar包的版本控制</li>
<li>JAR工程，用作jar包使用。即常见的本地工程——&gt;Java Project</li>
<li>WAR工程，将会打包成war，发布在服务器上的工程</li>
</ol>
<h4 id="3-在IDEA中创建Mavenue工程"><a href="#3-在IDEA中创建Mavenue工程" class="headerlink" title="3.在IDEA中创建Mavenue工程"></a>3.在IDEA中创建Mavenue工程</h4><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407103803854.png" alt="image-20210407103803854"></p>
<p>快照版一般意思就是非正式版，等你项目要上线的时候把snapshot去掉就行</p>
<h3 id="Maven目录结构"><a href="#Maven目录结构" class="headerlink" title="Maven目录结构"></a>Maven目录结构</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407104106849.png" alt="image-20210407104106849"></p>
<p>蓝色的Java文件夹存放我们写的Java源代码</p>
<p>resources存放主要的资源文件，比如xml配置文件和properties文件</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407105025623.png" alt="image-20210407105025623"></p>
<h3 id="导入依赖和派出依赖"><a href="#导入依赖和派出依赖" class="headerlink" title="导入依赖和派出依赖"></a>导入依赖和派出依赖</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407113222382.png" alt="image-20210407113222382"></p>
<p>项目1中导入了mybatis的依赖，项目2中要导入项目1的依赖，但是不想导入mybatis，可以使用exclusion来排除mybatis依赖</p>
<h3 id="依赖范围"><a href="#依赖范围" class="headerlink" title="依赖范围"></a>依赖范围</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407113845442.png" alt="image-20210407113845442"></p>
<p>加了dependencyManagement之后不会导入依赖，是对这个依赖进行管理：（一般在版本号上进行操作）</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407114810531.png" alt="image-20210407114810531"></p>
<p>要想把maven工程导出为jar包只需要点击右侧侧边栏的install即可</p>
<p>导入父工程：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407115136434.png" alt="image-20210407115136434"></p>
<p>relativePath指的是父工程的pom.xml配置文件的路径。</p>
<p>通过父工程配置过mybatis的版本号之后，子工程中注入mybatis依赖时不用写版本号，默认使用父工程中的版本号：</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407115417480.png" alt="image-20210407115417480"></p>
<p>maven的继承关系本质上就是POM.xml文件的继承关系</p>
<h3 id="聚合关系"><a href="#聚合关系" class="headerlink" title="聚合关系"></a>聚合关系</h3><p>聚合其实就包含了继承关系。定义一个总的POM项目，不写代码，专门用来聚合各个不同的项目模块</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407121823467.png" alt="image-20210407121823467"></p>
<p><packing>是在声明当前的项目类型，即当前的项目是一个什么类型的项目</p>
<h3 id="常用插件"><a href="#常用插件" class="headerlink" title="常用插件"></a>常用插件</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407123426745.png" alt="image-20210407123426745"></p>
<p>在.m2文件夹下的settings.xml里面配置的JDK版本是全局的，如果你想为项目单独指定JDK版本的话，可以使用上面这段代码，这个插件在右侧侧边栏的maven中可以找到</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407123550564.png" alt="image-20210407123550564"></p>
<p>没错，就是这个compiler插件</p>
<p>注意：如果想要把当前项目打包成jar包，需要点击install那个插件选项，安装（install）完之后，你的左侧项目文件中会出现一个target包，里面存放了一些打包好的文件，就是输出的jar包。</p>
<p>注意：只有放在resource目录下的配置文件才会被打包放入target中。但是蓝色的Java下面可能也会有一些配置文件，比如我们用mybatis的时候就会有。但是我们自己搞的时候不会有。</p>
<p>如果我们想把非resource目录下的文件打包成jar包，需要在pom.xml中配置如下信息：在<build>下面配置<resources></p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407124706015.png" alt="image-20210407124706015"></p>
<p>Tomcat插件：</p>
<p>创建maven时如果勾选了webapps选项，剩下的java和resources、test文件夹等都需要自己补全</p>
<p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407130140315.png" alt="image-20210407130140315"></p>
<img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407130109388.png" alt="image-20210407130109388" style="zoom: 50%;" />

<h3 id="Maven常用命令"><a href="#Maven常用命令" class="headerlink" title="Maven常用命令"></a>Maven常用命令</h3><p><img src="C:\Users\xiaoqiyao\AppData\Roaming\Typora\typora-user-images\image-20210407130701966.png" alt="image-20210407130701966"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/" class="post-title-link" itemprop="url">gradient descent</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-10-20 16:01:49 / Modified: 18:45:23" itemprop="dateCreated datePublished" datetime="2020-10-20T16:01:49+08:00">2020-10-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/computer/" itemprop="url" rel="index"><span itemprop="name">computer</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/" class="cy_cmt_count" data-xid="2020/10/20/机器学习笔记4/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>2.1k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h3><p>——Note4：gradient descent</p>
<p>先复习一下gradient descent的内容，如下图：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122180205343.png" alt="image-20210122180205343" style="zoom:50%;" />

<p>其中η是learning rate</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122181049006.png" alt="image-20210122181049006" style="zoom:50%;" />

<p>how to tuning(调整)learning rate</p>
<p>learning rate调的太小，gradient descent进行得太慢；调得太大，梯度下降可能会卡住甚至上升，参考下图的情况，不同情况不一样：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122181535183.png" alt="image-20210122181535183" style="zoom:50%;" />

<p>在这里再提示一下哈，调节gradient descent的目的是为了是loss function降到最低，也就是线性回归后的损失最小。</p>
<p>tensorflow迭代可以选择显示loss和精确度甚至是你自定义的函数。c的话就要靠自己编程了。——来自弹幕</p>
<p>调节learning rate的几个小技巧：</p>
<p>让η随着梯度下降的过程而减小，因为一开始距离最低点很远，后面慢慢地接近</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123101837557.png" alt="image-20210123101837557" style="zoom:50%;" />

<p>learning rate这种东西不是one-size-fits-all的，不同的参数需要给它不同的learning rate，那这件事情其实是有几个小技巧的，最容易实现也是最简单的叫做adagrad(自适应梯度算法)</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123105648734.png" alt="image-20210123105648734" style="zoom:50%;" />

<p>vanilla原意思是香草，在西方香草很常见，所以vanilla代表普通、普遍、基本的意思</p>
<p>vanilla 普通的，合起来就是  普通梯度下降</p>
<p>g是偏微分，对于第一个公式没有看懂的同学可以去看一下我写的笔记二里面的梯度下降公式，回顾一下就想起来了。</p>
<p>σt的意思是之前所有偏微分g的均方根，t不是次方，而是角标，第t个σ</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123105546103.png" alt="image-20210123105546103" style="zoom:50%;" />

<p>这个公式最终可以化成最下面那个那样，根号下t+1被约掉了</p>
<p>adaptive learning rate 其实有很多种方法，adagrad只是其中的一种方法之一，但这些方法都以ada开头</p>
<p>下面继续解释adagrad：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123111701467.png" alt="image-20210123111701467" style="zoom:50%;" />

<p>使用这种方法可以防止梯度爆炸，就是跨度越来越大</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123110406138.png" alt="image-20210123110406138" style="zoom:50%;" />

<p>我想在这里对这一节的内容做一个总结：这一节到底在讲什么呢？首先，根据梯度下降公式，我们可以得出随着gradient的进行，梯度下降的程度是越来越陡，这样可能会造成一个问题，就是错过loss function的最低点。为了防止这种梯度爆炸，我们需要调节偏微分g前面的参数learning rate，如何调节呢？learning rate不可能 one-fits-all，所以我们在前面加上和自变量t有关的式子，同时再乘上一个σ，发现约掉以后η就变成了根号下g的平方的和。因为在loss function接近最低点时，我们需要让gradient过程进行得越来越慢，才能保证loss function降到最低点。那么分母上乘以一个根号下g平方项的和，就可以帮助我们实现这种效果。那为什么要这样乘呢？</p>
<p>下面这几张图直接绝了好吧，醍醐灌顶：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123113030484.png" alt="image-20210123113030484" style="zoom:50%;" />

<p>比较不同参数时，发现距离越远微分值越大不成立，所以我们其实要把二次微分考虑进来：</p>
<p>这个其实叫二阶最优化算法，在花书的第58页上有，也叫牛顿迭代法——来自弹幕</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123113511656.png" alt="image-20210123113511656" style="zoom:50%;" />

<p>那这个方法和adagrad的关系是什么呢？</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123113952410.png" alt="image-20210123113952410" style="zoom:50%;" />

<p>当我们在一次微分的图上随便取一个sample时，它并不能反映二次微分的大小，但当我们取到了足够多的sample时，它其实可以反应二次微分的大小(一次微分的变化率)，那么adagrad分母上所做的事情其实就是在去、取足够多的，这样分母就可以反映出二次微分的大小。</p>
<h3 id="Gradient-Descent"><a href="#Gradient-Descent" class="headerlink" title="Gradient Descent"></a>Gradient Descent</h3><h4 id="tip-2：stochastic-gradient-descent-随机梯度下降-SGD"><a href="#tip-2：stochastic-gradient-descent-随机梯度下降-SGD" class="headerlink" title="tip 2：stochastic gradient descent 随机梯度下降(SGD)"></a>tip 2：stochastic gradient descent 随机梯度下降(SGD)</h4><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123114653351.png" alt="image-20210123114653351" style="zoom:50%;" />

<p>随机的很快，每次只算一个，上面的梯度下降每次要算所有的函数的loss</p>
<p>随机梯度下降不一定按gradient建议我们的方向去走，但是它的速度很快</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123120248542.png" alt="image-20210123120248542" style="zoom:50%;" />



<h4 id="tip3-Feature-Scaling-特征缩放"><a href="#tip3-Feature-Scaling-特征缩放" class="headerlink" title="tip3 Feature Scaling(特征缩放)"></a>tip3 Feature Scaling(特征缩放)</h4><img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123120357726.png" alt="image-20210123120357726" style="zoom:50%;" />

<p> 假设x1和x2是宝可梦的两个不同特征值，一个是cp值，一个是hp值，从图1中可以发现x1和x2的变化范围相差较大，这个时候就要对他们进行特征缩放，使它们的变化范围大致相同。为什么要这么做呢？</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123120229975.png" alt="image-20210123120229975" style="zoom:50%;" />

<p>第一个图，你拐了一个弯，你不会指向最低点去走，但是第二图中，如果它真的是一个正圆的话，你不管在哪个位置，你都会直接向着圆心走，可以提高效率。</p>
<p>在之前讲gradient descent时讲到了这样一个图：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122110249551.png" alt="image-20210122110249551" style="zoom:50%;" />

<p>把前面的二维图放在三维进行gradient descent大概就是这样。</p>
<p>那feature scaling的方法有很多种，常见的做法是下面这种：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123121450486.png" alt="image-20210123121450486" style="zoom:50%;" />

<p>mean是平均值，standard deviation是标准差</p>
<p><strong>接下来讲一点理论的东西，为什么gradient descent会work，它背后的理论基础是什么？</strong></p>
<p>在进入正题之前，给大家一个<strong>warning of math</strong>，这个部分没有听懂也没关系，明天的太阳依旧会升起</p>
<p>optimization problem：最优化问题    </p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123161213604.png" alt="image-20210123161213604" style="zoom:50%;" />

<p>使用Taylor series 证明了gradient descent 过程的来源</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123161330200.png" alt="image-20210123161330200" style="zoom:50%;" />

<p>you can consider the second order term, e.g Newton’s method.</p>
<p>梯度下降的局限性：梯度消失</p>
<p>当梯度消失的时候，你不一定就接近了local minima，有可能 loss function 还在高原地区，比如下面这张图：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210123162225658.png" alt="image-20210123162225658" style="zoom:50%;" />

<p>而且你也不知道你的 local minima 是不是 global minima。</p>
<p>这是一个有意思的问题，下一节学习最优化。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/" class="post-title-link" itemprop="url">Basic Concept</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-10-20 15:59:49 / Modified: 18:41:23" itemprop="dateCreated datePublished" datetime="2020-10-20T15:59:49+08:00">2020-10-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/computer/" itemprop="url" rel="index"><span itemprop="name">computer</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/" class="cy_cmt_count" data-xid="2020/10/20/机器学习笔记3/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>1.7k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h3><p>——Note3：Basic Concept</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122151636090.png" alt="image-20210122151636090" style="zoom:50%;" />

<p>erro有两个来源，一个是bias(偏移量，就是函数中的b)；一个是方差variance</p>
<p>(下面这个图两个糖葫芦反了)</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122153928315.png" alt="image-20210122153928315" style="zoom:50%;" />

<p>平均值就是你的n个样本值相加再乘以1/n，这个好理解，方差的算法和我们平时所学的也一样。</p>
<p>下面是一个很形象的图，很好的解释了bias和variance对数据结果的影响</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122153950542.png" alt="image-20210122153950542" style="zoom: 50%;" />

<p>越简单的模型越不容易受数据量的影响，比如下面这个图：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122155112746.png" alt="image-20210122155112746" style="zoom:50%;" />

<p>因为后者的函数中含有x的五次方，所以受数据量变化的影响比较大。</p>
<p>下面这个图，分别代表一次的、三次的、五次的函数进行regression的过程，分别进行了5000次拟合，取的平均值。图中黑线是真正的函数(宝可梦游戏公司研发出来的函数)，蓝色的是5000次拟合出来的函数的平均函数。可以惊人的发现，五次式虽然方差大，但是取了平均值以后结果居然与true function惊人的一致！</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122160119827.png" alt="image-20210122160119827" style="zoom:50%;" />

<p>下面这个图直观的解释了为什么会这样：model的范围问题，第二个图的model范围虽然比第一个更大，但是平均下来却能很好地定位在true function的附近</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122160707476.png" alt="image-20210122160707476" style="zoom:50%;" />

<p>下面的一个图更是出神入化地解释了这个问题的本质：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122161203412.png" alt="image-20210122161203412" style="zoom:50%;" />

<p>当你的拟合函数比较简单时，数据偏差bias会比较大，但是方差variance会比较小</p>
<p>当你的拟合函数比较复杂时，数据偏差bias会变小，但是方差variance会变大。</p>
<p>上面的三条曲线解释了bias误差和variance误差所结合带来的效果。当variance误差过大，我们称作overfitting(过拟合)，当bias误差过大，我们称作underfitting(欠拟合)</p>
<p>怎么判断你的误差是哪一种呢？下面两张图：</p>
<p>for underfitting(error from bias)，your model can’t even fit the training examples，you should redesign your model，maybe create a more complex model</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122161930653.png" alt="image-20210122161930653" style="zoom:50%;" />

<p>for overfitting：</p>
<p>过拟合时有两个办法，一个是增大你的数据集，但是通常不现实，因为很多时候其实你没有办法获得更多的数据。</p>
<p>还有一个方法可以帮助你获得更多的数据，就是在条件允许的情况下自己创造数据。比如手写输入识别，用户手写一个数据，你可以将用户输入的每个数据进行五十度旋转后得到更多的数据。再比如影响辨识，你只有一个从左边开过来的火车，，没有从右边开过来的火车，你可以把你的影像颠倒，这样你就得到了更多的data。有很多很多方法可以帮你得到更多的data，不是仅限于采集数据。</p>
<p>如果你没有办法connect更多data的话，还有另外一招，叫做regularization。（上一讲中提到的，在后面加一项使你的曲线变得更加的平滑）</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122163958205.png" alt="image-20210122163958205" style="zoom:50%;" />

<p>但是这样做有一个问题，就是你把曲线变得平滑的同时确实是减小了variance，但是有可能会导致bias变大(就像之前模型过于简单时那样，所以在regularization的时候要注意这个问题)</p>
<p>其实在regularization中还有很多参数可以调，通常我们是在bias和variance之间寻找平衡(trade-off)</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122164535524.png" alt="image-20210122164535524" style="zoom:50%;" />

<p>训练集、验证集、测试集。我们手上的testing set测试完training set之后你可能会直接选择误差最小的那个测试集，但实际的real testing set是你手上没有的。</p>
<p>“测试集应尽可能符合部署真实场景的分布，否则交叉验证再高也是徒劳，最好的数据集应该设为测试集”——来自弹幕</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122164954008.png" alt="image-20210122164954008" style="zoom:50%;" />

<p>所以public set的验证其实是不太可靠的，那要怎么做呢？你要把你的training set分为两组：</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122165626113.png" alt="image-20210122165626113" style="zoom:50%;" />

<p>training set中自己先验证一次，然后再用验证集验证一次，这种方法又被称为交叉验证。</p>
<p>training set分为training set和validation(验证) set。而此时你的测试集public testing set就成为了真正的测试集</p>
<p>如果你担心你的training set分不准，可以使用n折交叉验证</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122170028934.png" alt="image-20210122170028934" style="zoom:50%;" />

<p>但是有一个原则是，如果你不太关注你在public testing set上出现的差距的话，你在private testing set上得出的误差往往是比较小的。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mozartto.cn/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Motto">
      <meta itemprop="description" content="a blog about some record in life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Motto">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/" class="post-title-link" itemprop="url">机器学习Note1</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-10-20 15:54:49 / Modified: 18:40:23" itemprop="dateCreated datePublished" datetime="2020-10-20T15:54:49+08:00">2020-10-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/computer/" itemprop="url" rel="index"><span itemprop="name">computer</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://mozartto.cn/2020/10/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/" class="cy_cmt_count" data-xid="2020/10/20/机器学习笔记1/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>1.4k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Machine-Learning"><a href="#Machine-Learning" class="headerlink" title="Machine Learning"></a>Machine Learning</h3><p>——Note1：基本概念</p>
<p>前几天看了一下爱奇艺的推荐系统那个项目，发现还是得补一下ML，虽然说以后不搞这个(太累了，而且以后大概率炼丹)。不过做开发的了解一下ML知识也不错。目前在自学ML。公众号/博客上的文章是我的ML学习笔记，这个系列大概会写60篇左右的笔记。</p>
<p>本篇文章是对于机器学习所作的一篇非常简短的介绍。</p>
<p>机器学习的本质，就是我们想好一个函式，输入一段内容，通过这个函式的运算转换为我们想要的内容进行输出。</p>
<ol>
<li>Regression：回归</li>
<li>Binary-Classification：二元分类</li>
<li>Multi-Class Classification：多元分类</li>
</ol>
<blockquote>
<p>regression是让机器输出一个数值</p>
<p>classification是让机器做选择</p>
</blockquote>
<ol start="4">
<li>Generation：生成。让机器自己去学习怎么做，去创造内容。</li>
</ol>
<p>怎么告诉机器我们想好的函式呢？——supervised learning 监督式学习。在supervised learning里面，我们需要提供给机器大量的数据，即labeled data 被标记过的图片</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122074559312.png" alt="image-20210122074559312" style="zoom:50%;" />

<p>提供给机器labeled data之后，机器就会评估一个函式的好坏，即函式的loss。一个function的loss越小越好</p>
<p>reinforcement learning：强化学习 （Alfago）</p>
<p>supervised learning VS reinforcement learning</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122075410508.png" alt="image-20210122075410508" style="zoom:50%;" />

<p>强化学习通过reward引导机器学习。</p>
<p>unsupervised learning：无监督式学习。给机器的是无标注的数据</p>
<p>让机器寻找函式的方法：gradient Descent 梯度下降法</p>
<h6 id="前沿研究"><a href="#前沿研究" class="headerlink" title="前沿研究"></a>前沿研究</h6><ol>
<li><p>explainable AI    这个是什么意思呢？比如我现在给机器一张猫的图片，它输出cat。那它认为图片里的东西是猫的理由是什么呢？它可以解释，这个就是explainable AI</p>
</li>
<li><p>adversarial attack：刻意攻击。人为的给机器制造杂讯和噪音，比如在猫的图片里刻意加上一些东西让机器辨认失误。</p>
</li>
<li><p>network compression：网络压缩。现在机器学习系统的数据量很大，一般没有办法放在个人手机或电脑上，network compression的工作就是想办法让数据能够放在edge device(边缘设备)上。</p>
</li>
<li><p>anomaly detection：异常检测</p>
</li>
<li><p>domain adversarial learning</p>
</li>
<li><p>meta learning：learn how to learn</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122082107263.png" alt="image-20210122082107263" style="zoom:50%;" /></li>
</ol>
<p>机器学习想要达到和人类一样的水平，比如玩一个小游戏，机器学习4000个小时可以达到4000分，而人类只需要学习两个小时就可以达到4000分。所以机器靠的是后天努力，而不是先天优势。meta learning就是去想办法提升机器的先天优势。</p>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122082432921.png" alt="image-20210122082432921" style="zoom:50%;" />

<p>life-long learning（终身学习）</p>
<blockquote>
<p>作业的角越多难度越大，比如圈圈最简单，五角星最难。</p>
<p>作业学习路线箭头路径仅供参考</p>
</blockquote>
<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122082740740.png" alt="image-20210122082740740" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/Mozartto/pictures/Mozarttoimage-20210122082900740.png" alt="image-20210122082900740" style="zoom:50%;" />

<p>完全可以在家自学！网页中每个作业都有助教的Colab范例，照做就能完成一半！每个作业都有录影说明。</p>
<blockquote>
<p>注意：强烈建议使用Linux或macOS系统来完成作业！Windows系统常常独立运行，很容易出问题.</p>
<p>没装过系统的建议先使用能够快速上手的Ubuntu</p>
<p>所有的作业都必须以python3.6.8来完成</p>
<p>管理python库的pyenv，这个后面再用</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>
<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">黔ICP备 2021003893 </a>
      <img src="/images/beian.png"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=2021003893" rel="noopener" target="_blank">黔网公安备 2021003893 </a>
  </div>

<div class="copyright">
  &copy; 2020 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fas fa-battery-full"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Motto</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Symbols count total: </span>
    <span title="Symbols count total">201k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">3:02</span>
  </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{&quot;enable&quot;:true,&quot;tags&quot;:&quot;none&quot;,&quot;js&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mathjax@3.1.4&#x2F;es5&#x2F;tex-mml-chtml.js&quot;}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="changyan" type="application/json">{&quot;enable&quot;:true,&quot;appid&quot;:&quot;cyvsVbDPQ&quot;,&quot;appkey&quot;:&quot;850d54eeada1b129a1fa523dedb189ff&quot;}</script>
<script src="/js/third-party/comments/changyan.js"></script>

</body>
</html>
